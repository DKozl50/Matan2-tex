\documentclass[a4paper, fleqn]{article}

\usepackage{header}

\usepackage[noend]{algorithmic}
\renewcommand{\algorithmicensure}{\textbf{function}} % use \ENSURE to define function
\renewcommand{\algorithmicrequire}{\textbf{procedure}} % use \REQUIRE to define procedure

\DeclareMathOperator{\dom}{\mathop{\mathrm{dom}}}
\DeclareMathOperator{\rng}{\mathop{\mathrm{rng}}}
\newcommand{\pair}[1]{\langle#1\rangle}
\newcommand{\wo}{\setminus} % AKA without
\newcommand{\void}{\varnothing} % пустое множество
\newcommand{\udv}{\text{не опр.}} % Undefined value
\newcommand{\mred}{\leqslant_m} % m-сводимость
\newcommand{\plot}{\text{Г}} % график функции

\title{Коллоквиум по Дискретной Математике-2}
\author{
    % Откомментируй себя или добавь в список!
    % Александр Богданов   \\ \href{https://t.me/SphericalPotatoInVacuum}{Telegram} \and
    Алиса Вернигор       \\ \href{https://t.me/allisyonok}{Telegram} \and
    % Анастасия Григорьева \\ \href{https://t.me/weifoll}{Telegram} \and
    Валерий Березовский  \\ \href{https://t.me/jeembogod}{Telegram} \and
    Василий Шныпко       \\ \href{https://t.me/yourvash}{Telegram} \and
    % Данил Казанцев       \\ \href{https://t.me/vserosbuybuy}{Telegram} \and
    % Даниэль Хайбулин     \\ \href{https://t.me/kiDaniel}{Telegram} \and
    Денис Козлов         \\ \href{https://t.me/DKozl50}{Telegram} \and
    % Елизавета Орешонок   \\ \href{https://t.me/eaoresh}{Telegram} \and
    % Иван Пешехонов       \\ \href{https://t.me/JohanDDC}{Telegram} \and
    % Иван Добросовестнов  \\ \href{https://t.me/ivankot13}{Telegram} \and
    Ира Голобородько     \\ \href{https://t.me/Ira4kgl}{Telegram} \and
    Марк Рофин           \\ \href{https://t.me/Broccoliman}{Telegram} \and
    % Настя Городилова     \\ \href{https://t.me/nastygorodi}{Telegram} \and
    Никита Насонков      \\ \href{https://t.me/nnv_nick}{Telegram} \and
    Оля Козлова          \\ \href{https://t.me/grenlayk}{Telegram}
    % Сергей Лоптев        \\ \href{https://t.me/beast_sl}{Telegram} \and
}

\date{Версия от {\ddmmyyyydate\today} \currenttime}

% После комментария с номером пишем формулировку вопроса в subsection{...}
% К примеру:

% Вопрос 1
% \subsection{Перечислимые множества суть, в точности, проекции разрешимых.}
% и тут уже решение формулировочки все дела

\begin{document}
    \maketitle

    Спасибо команде \href{https://github.com/hse-tex/hse-tex}{hse-tex} 
    и в частности Сергею Пилипенко за конспекты лекций. 

    Спасибо Демиду Васильеву за предоставленные материалы по вычислимости.

    \tableofcontents

    \newpage

\section{Обозначения в разделе вычислимости}

    \begin{itemize}
        \item Алгоритмы и машины Тьюринга обозначаются рукописными буквами, например, $\mathcal{M}$ (читается как <<M-красивое>> по Дашкову).

        \item $\dom f$ и $\rng f$ --- области определения и значений функции $f$ соответственно.

        \item Мы не пользуемся записью вида $f : A \xrightarrow{p} B$ для частичных функций, а явно указываем, если рассматриваемая функция тотальна.

        \item Привычно равенство функций обозначать как $f = g$, но так как в данном курсе рассматриваются и не всюду определенные функции, то $f(x) \simeq g(x) \iff$ в точке $x$ функции совпадают по значению либо обе не определены.

        \item Функции $\xi$ и $\text{id}_{\NN}$ --- нигде не определенная и тождественная соответственно.
    \end{itemize}

\section{Вопросы по вычислимости}

    % Вопрос вычислимость 1
    \subsection{Вычислимые функции (при интуитивном понимании алгоритма). Разрешимые и перечислимые множества. Связь конечности, разрешимости и перечислимости. Разрешимые множества под действием операций алгебры множеств и декартова произведения. [R, с. 3–4]}

        Алгоритмом в его интуитивном понимании считается конечная последовательность инструкций, которая исполняется по шагам. Алгоритм может принимать на вход аргументы и выдавать какой-то результат.

        \begin{definition}
        Функция $f$ вычислима, если существует алгоритм $\mathcal{A}$, вычисляющий ее. Это значит, что для любого входа $x \in \dom f$ $\mathcal{A}$ выдает результат $f(x)$ за конечное число шагов, а при $x \notin \dom f$ зацикливается (причем неважно, естественным или искусственным образом).
        \end{definition}

        \begin{definition}
        Множество $A$ разрешимо, если вычислима его характеристическая функция
        \begin{equation*}
        \begin{gathered}
        \chi_A(x) =
        \begin{cases}
        1, & x \in A \\
        0, & x \notin A \\
        \end{cases}.
        \end{gathered}
        \end{equation*}
        \end{definition}

        \begin{definition}
        Множество $A$ перечислимо, если существует алгоритм-<<перечислитель>> $\mathcal{A}$ без входа, печатающий каждый элемент $A$ за конечное число шагов, и только элементы $A$. Также $A$ перечислимо тогда и только тогда, когда вычислима его полухаракетристическая функция
        \begin{equation*}
        \begin{gathered}
        \omega_A(x) =
        \begin{cases}
        1, & x \in A \\
        \udv, & x \notin A \\
        \end{cases}.
        \end{gathered}
        \end{equation*}
        Эквивалентность этих определений доказана в билете 4.
        \end{definition}

        \begin{proposition}
            Из конечности множества следует его разрешимость, а из разрешимости --- перечислимость.
        \end{proposition}

        Если $A = \{a_1, a_2, \dots, a_n\}$ конечно, то приведенный ниже код вычисляет характеристическую функцию:

        \algsetup{indent=2em}
        \begin{algorithmic}
        \ENSURE $\chi_A(x)$
            \IF{$x = a_1$ \OR $x = a_2$ \OR $\dots$ \OR $x = a_n$}
                \RETURN 1
            \ELSE
                \RETURN 0
            \ENDIF
        \end{algorithmic}

        %\verb'def' $\chi_A$\verb'(x):'
        %\verb'    return 1 if (x ==' $a_1$ \verb'or x ==' $a_2$ \verb'or' $\dots$ \verb'or x ==' $a_n$\verb') else 0'

        Для бесконечного множества такой трюк невалиден, так как код должен быть \textbf{конечной} последовательностью байт.

        Если $A$ разрешимо, то его характеристическая функция $\chi_A$ вычислима, поэтому данный алгоритм рано или поздно обработает каждое натуральное число, не зациклившись:

        \begin{algorithmic}
        \REQUIRE {\scshape print$_A$()}
            \FORALL{$x \in \NN$}
                \IF{$\chi_A(x)$}
                    \PRINT $x$
                \ENDIF
            \ENDFOR
        \end{algorithmic}

        %\verb'def print'$_A$\verb'(x):'
        %\verb'    x = 0'
        %\verb'    while True:'
        %\verb'        if' $\chi_A$\verb'(x):'
        %\verb'            print(x)'
        %\verb'        x += 1'

        \begin{proposition}
            Из разрешимости $A$ и $B$ следует разрешимость $A \cap B, \; A \cup B, \; \bar A, \; A \times B$.
        \end{proposition}

        \begin{proof}
        Достаточно предъявить характеристические функции данных множеств:

        \begin{itemize}
            \item $\chi_{A \cap B}(x) = \chi_{A}(x) \cdot \chi_B(x)$
            \item $\chi_{A \cup B}(x) = \chi_{A}(x) + \chi_B(x) - \chi_{A \cap B}(x)$
            \item $\chi_{\bar A}(x) = 1 - \chi_{A}(x)$
            \item $\chi_{A \times B}((x, y)) = \chi_A(x) \cdot \chi_B(y)$
        \end{itemize}

        Понятно, что эти функции вычислимы как композиции вычислимых.
        \end{proof}

    % Вопрос вычислимость 2
    \subsection{Перечислимые множества под действием операций алгебры множеств, декартова произведения и проекции. Теорема Поста. [R, 3--4]}

        \begin{proposition}
             Из перечислимости $A$ и $B$ следует перечислимость $A \cap B, \; A \cup B, \; A \times B, \; \pr^i A$.
        \end{proposition}

        \begin{proof}
        Предложим алгоритмы перечисления этих множеств, подразумевая, что $\mathcal{A}$ и $\mathcal{B}$ --- перечислители $A$ и $B$ соответственно:

        \begin{enumerate}[leftmargin=15mm]
            \item[$A \cap B \;$] Будем параллельно исполнять $\mathcal{A}$ и $\mathcal{B}$ по шагам и сохранять вывод каждого в два буфера. Время от времени (скажем, после каждых 2020 шагов) за конечное время просматриваем оба буфера и выводим элементы, оказавшиеся в обоих. Перечислимость можно также вывести как $\omega_{A \cap B}(x) = \omega_{A}(x) \cdot \omega_B(x)$.

            \item[$A \cup B \;$] Достаточно подать вывод как $\mathcal{A}$, так и $\mathcal{B}$ на выход перечислителя $A \cup B$.

            \item[$A \times B \;$] Аналогично случаю $A \cap B$, только выводить нужно все пары $(a, b) \in A' \times B'$, где $A'$ и $B'$ --- буферы в текущий момент исполнения $\mathcal{A}$ и $\mathcal{B}$. Перечислимость можно также вывести как $\omega_{A \times B}((x, y)) = \omega_A(x) \cdot \omega_B(y)$.

            \item[$\pr^i A \;$] Проекцией $\pr^i A$ называется множество $\{ b \in \NN \mid \exists a_1, \dots, a_k \!: (a_1, \dots, a_{i-1}, \, b, \, a_{i+1}, \dots, a_k) \in A \}$ при $A \subseteq \NN^k$ и $1 \leq i \leq k$. Чтобы перечислить проекцию, запустим $\mathcal{A}$ и будем выводить каждую $i$-тую координату всех полученных элементов множества. \qedhere
        \end{enumerate}
        \end{proof}

        Заметим, что перечислимость $A$ не гарантирует перечислимость $\bar A$ из-за проблемы <<остановки>>: на любом конечном количестве шагов работы перечислителя непонятно, по какой причине он не вывел конкретное число.

        \begin{theorem}[Поста]
            Множество $A$ разрешимо тогда и только тогда, когда $A$ и $\bar A$ перечислимы.
        \end{theorem}

        \begin{proof}
        Из билета 1: $A$ разрешимо $\implies \bar A$ разрешимо. Из разрешимости следует перечислимость, следовательно $A$ и $\bar A$ перечислимы.

        В обратную сторону. Хотим узнать истинность $x \in A$. Для этого будем по очереди исполнять по шагам перечислитель то $A$, то $\bar A$. Так как $x \in \NN = A \cup \bar A$, то $x$ будет напечатан перечислителем ровно одного из двух множеств за конечное число шагов. Если это был перечислитель $A$, то $x \in A$, иначе $x \notin A$. Иными словами,

        \begin{equation*}
        \begin{gathered}
        \chi_A(x) =
        \begin{cases}
        1, & \omega_A(x) = 1 \\
        0, & \omega_{\bar A}(x) = 1 \\
        \end{cases}.
        \end{gathered}\qedhere
        \end{equation*}
        \end{proof}

    % Вопрос вычислимость 3
    \subsection{Теорема о графике вычислимой функции. Перечислимость образа и прообраза множества под действием вычислимой функции. [R, 14]}

        \begin{definition}
        Графиком функции $f : \NN \to \NN$ называется множество его точек $\plot_f = \{ (x, y) \in \NN^2 \mid f(x) = y \}$.
        \end{definition}

        \begin{theorem}[о графике]
        Функция $f$ вычислима $\iff \plot_f$ перечислим.
        \end{theorem}

        \begin{proof}
        \begin{enumerate}
            \item[]

            \item[$\implies$] Перечислим все пары $(x, k) \in \NN^2$, и для каждой запустим алгоритм, вычисляющий $f(x)$. Если спустя $k$ шагов был возвращен результат $y$, то даем на выход точку $(x, y)$ графика. Иначе переходим к следующей паре $(x', k')$. Заметим, что если $f$ не определена в какой-то точке, то никакие конечные $k$ шагов не выдадут значение функции, поэтому алгоритм корректен.

            \item[$\Longleftarrow\;$] Запустим перечислитель $\mathcal{G}$ графика $\plot_f$. Если $f(x)$ определено, то спустя конечное число шагов $\mathcal{G}$ напечатает пару вида $(x, y)$, и тогда верно $f(x) = y$. Иначе $x \notin \pr^1 \plot_f$, и в таком случае $\mathcal{G}$ будет работать бесконечно, что и требуется при неопределенном значении $f$ в точке $x$. \qedhere
        \end{enumerate}
        \end{proof}

        \begin{proposition}
        Функция $f$ вычислима и тотальна $\implies \plot_f$ разрешим.
        \end{proposition}

        \begin{proof}
        \begin{enumerate}
        \item[]

        \item[$\implies$]
        \begin{equation*}
        \begin{gathered}
        \chi_{\plot_f}((x, y)) \;=\;
        \begin{cases}
        1, & (x, y) \in \plot_f \\
        0, & (x, y) \notin \plot_f \\
        \end{cases}
        \;=\;
        \begin{cases}
        1, & f(x) = y \\
        0, & f(x) \ne y \\
        \end{cases}
        \text{ --- \, вычислима.}
        \end{gathered}
        \end{equation*}

        % \item[$\Longleftarrow$]
        % \begin{algorithmic}
        % \ENSURE $f(x)$
        %     \FORALL{$y \in \NN$}
        %         \IF{$\chi_{\plot_f}((x, y))$}
        %             \RETURN $y$
        %         \ENDIF
        %     \ENDFOR
        % \end{algorithmic}
        \end{enumerate}
        \end{proof}

        \begin{proposition}
            Если $f : \NN \to \NN$ вычислима и $A$ перечислимо, то $f(A)$ и $f^{-1}(A)$ перечислимы.
        \end{proposition}

        \begin{proof}
            Заметим, что $f(A) = \pr^2 \bigl( \plot_f \cap (A \times \NN) \bigr)$ и $f^{-1}(A) = \pr^1 \bigl( \plot_f \cap (\NN \times A) \bigr)$. Оба перечислимы, так как проекция, пересечение и декартово произведение перечислимых множеств перечислимы (билет 2).
        \end{proof}

        \begin{corollary}
            Если $f : \NN \to \NN$ вычислима, то $\dom f = f^{-1}(\NN)$ и $\rng f = f(\NN)$ перечислимы.
        \end{corollary}

    % Вопрос вычислимость 4
    \subsection{Перечислимые множества суть, в точности, области определения вычислимых функций. [R, 10]}

        См. утверждение $(1) \iff (3)$ из теоремы ниже.

        \begin{theorem}[равносильные определения перечислимости]
            Следующие утверждения о произвольном множестве $A \subseteq \NN$
            эквивалентны:
            \begin{enumerate}[label=(\arabic*)]
                \item $A$ перечислимо;
                \item полухаракетристическая функция $\omega_A(x) \simeq
                \begin{cases}
                1, & x \in A \\
                \udv, & x \notin A \\
                \end{cases}$
                вычислима;
                \item существует вычислимая функция $f : \NN \to \NN$, такая что $A = \dom f$;
                \item существует вычислимая функция $f : \NN \to \NN$, такая что $A = \rng f$;
                \item $A = \void$ или существует вычислимая тотальная функция $f : \NN \to \NN$, такая что $A = \rng f$;
                \item существует разрешимое $B \subseteq \NN^2$, такое что $A = \pr^i B$.
            \end{enumerate}
        \end{theorem}

        \begin{proof}
        \begin{enumerate}[leftmargin=22mm]
            \item[]
            \item[(1) $\iff$ (2)] Запустим перечислитель $\mathcal{A}$. Если в выводе встречается $x$, то $\omega_A(x) = 1$, иначе алгоритм зациклится на входе $x \notin A$. В обратную сторону: $\dom \omega_A = A \implies A$ перечислимо (см. билет 3).

            \item[(1) $\iff$ (3)] $\dom f = A \implies A$ перечислимо; если $A$ перечислимо, то за $f$ можно взять $\omega_A$.

            \item[(1) $\iff$ (5)] Пусть $A \ne \void$ перечислимо и $\mathcal{A}$ напечатал первое число ровно после $k$ шагов. Тогда зададим $f(n)$ как последнее выведенное перечислителем число ровно после $n + k$-того шага алгоритма. Обратно: $\mathcal{A}$ по очереди перечисляет пары $(x, k) \in \NN^2$ и эмулирует вычисление $k$ шагов значения $f(x)$. $\mathcal{A}$ печатает результат $y$, если он есть, и переходит к следующей паре $(x', k')$.

            \item[(1) $\iff$ (4)] Если $A = \void$, то подойдет $f = \xi$, иначе достаточно взять функцию, описанную в предыдущем пункте. Обратно: аналогично предыдущему пункту.

            \item[(1) $\iff$ (6)] Если $A = \void$, то подойдет $B = \void$, иначе достаточно взять функцию $f$, описанную в пункте $(1) \iff (5)$, и задать $B = \plot_{f}$, тогда $A = \pr^2 B$. Обратно: $B$ разрешимо $\implies B$ перечислимо $\implies \pr^1 B = A$ перечислимо. \qedhere
        \end{enumerate}
        \end{proof}

    % Вопрос вычислимость 5
    \subsection{Непустые перечислимые множества суть, в точности, области значений вычислимых тотальных функций. [R, 10, с. 4]}

        См. утверждение $(1) \iff (5)$ из билета 4.

    % Вопрос вычислимость 6
    \subsection{Перечислимые множества суть, в точности, проекции разрешимых. [R, 10]}

        См. утверждение $(1) \iff (6)$ из билета 4.

    % Вопрос вычислимость 7
    \subsection{Универсальная вычислимая функция (в классе вычислимых функций $\NN \to \NN$). T-Предикат. [R, 7–8]}

        \begin{definition}
        Отображение $U : \NN^2 \to \NN$ --- универсальная вычислимая функция (УВФ), если (а) $U$ вычислима и (б) для любой вычислимой $f : \NN \to \NN$ найдется $n \in \NN$, такое что $\forall x \in \NN \;\; U(n, x) \simeq f(x)$. Иными словами, сечение $U_n$ совпадает с $f$.
        \end{definition}

        Функция $d : \NN \to \NN$ называется диагональю функции $V : \NN^2 \to \NN$, если $\forall x \in \NN \;\; d(x) \simeq V(x, x)$.

        \textbf{Неформально:} алгоритмы можно рассматривать как конечные последовательности байт, поэтому их счетно и каждому тексту программы можно сопоставить его номер из $\NN$. Он и есть первый аргумент $U$, а второй --- аргумент функции, которую вычисляет алгоритм. Получается, УВФ эмулирует вычисление всех вычислимых функций одного аргумента.

        Пусть $U$ --- УВФ, а $\mathcal{U}$ --- алгоритм, вычисляющий ее.

        \begin{definition}
        $T$-предикат --- подмножество $\NN^3$, такое что $(n, x, k) \in T$ тогда и только тогда, когда $\mathcal{U}$ останавливается на входе $(n, x)$ за $k$ шагов. $T'$-предикат --- подмножество $\NN^4$, такое что $(n, x, y, k) \in T$ тогда и только тогда, когда $\mathcal{U}$ останавливается на входе $(n, x)$ за $k$ шагов и возвращает $y$. Ясно, что оба отношения разрешимы, так как можно исполнить $k$ шагов вычисляющего алгоритма и проверить, остановился ли он и вывел ли что-то.
        \end{definition}

    % Вопрос вычислимость 8
    \subsection{Неразрешимость проблем самоприменимости и остановки. Примеры перечислимого неразрешимого и неперечислимого множеств. [R, 23]}

        \begin{proposition}
        Существует перечислимое неразрешимое множество.
        \end{proposition}

        \begin{proof}
        Пусть $U$ --- УВФ. Рассмотрим $K_U = \{ n \in \NN \mid U(n, n) \text{ определено} \} = \dom d_U$. $d_U$ вычислима $\implies K_U = \dom d_U$ перечислимо. \\

        Предположим, что $K_U$ разрешимо, тогда по теореме Поста $\bar K_U$ перечислимо. Тогда вычислима функция

        \begin{equation*}
        \begin{gathered}
        r(x) \simeq \omega_{\bar K_U}(x) \simeq
        \begin{cases}
        1, & x \notin K_U \\
        \udv, & x \in K_U
        \end{cases}.
        \end{gathered}
        \end{equation*}

        Тогда $\exists n \in \NN : \; U_n = r \implies U(n, n) \simeq r(n)$. Приходим к двум случаям:

        \begin{itemize}
            \item $U(n, n)$ определено $\implies n \in \dom d_U \implies n \in K_U \implies r(n)$ не определено, но $U(n, n)$ определено.

            \item $U(n, n)$ не определено $\implies n \notin \dom d_U \implies n \notin K_U \implies r(n) = 1$, но $U(n, n)$ не определено.
        \end{itemize}

        Пришли к противоречию, следовательно $r$ невычислима $\implies$ $\bar K_U$ неперечислимо $\implies K_U$ неразрешимо по теореме Поста. \\

        Итак, $K_U = \dom d_U$ --- искомое перечислимое неразрешимое множество.
        \end{proof}

        Заметим, что найденное $K_U$ --- множество всех программ, останавливающихся на входе из своего текста, поэтому теорема называется также проблемой самоприменимости, которая, как оказалось, неразрешима, то есть невозможно за конечное число шагов узнать, остановится ли программа на входе, совпадающим с ее текстом.

        Эта проблема связана также с проблемой остановки. Рассмотрим $S_U = \dom U \subseteq \NN^2$ --- перечислимое из вычислимости $U$. Сведем $S_U$ к $K_U$, заметив, что $n \in K_U \iff U(n, n)$ определено $\iff (n, n) \in S_U$. Отсюда сразу можем заключить, что $S_U$ неразрешимо $\implies$ проблема остановки неразрешима.

        Таким образом, не существует программы, которая бы за конечное число шагов определяла, остановится ли произвольная программа на любом входе либо входе, совпадающим с ее текстом.

    % Вопрос вычислимость 9
    \subsection{Пример вычислимой функции, не имеющей вычислимого тотального продолжения. [R, 29]}

        \begin{proposition}
        Пусть $U$ --- УВФ и $d$ --- ее диагональ. Тогда для любой вычислимой функции $f : \NN \to \NN$ существует $n \in \NN : \;\; f(n) \simeq d(n)$.
        \end{proposition}

        \begin{proof}
        Ввиду универсальности $U$ найдется номер $n \in \NN : \;\; U_n = f$. Тогда $f(n) \simeq U(n, n) \simeq d(n)$.
        \end{proof}

        \begin{corollary}
        Функция $f$ невычислима, если $\forall n \in \NN \;\; f(n) \not\simeq d(n)$.
        \end{corollary}

        \begin{definition}
        Функция $g : \NN \to \NN$ называется продолжением $f : \NN \to \NN$, если $\forall x \in \dom f \;\, g(x) = f(x)$. Иными словами, $\plot_f \subseteq \plot_g$.
        \end{definition}

        Пусть $d$ --- диагональ произвольной УВФ $U$, а $d'$ --- ее тотальное вычислимое продолжение, тогда функция $g(x) = d'(x) + 42$ тотальна и вычислима как композиция вычислимых тотальных функций. Но $g$ не совпадает с $d$ ни в одной точке, следовательно она не может быть вычислимой --- противоречие.

        Таким образом, диагональная функция произвольной УВФ не имеет тотального вычислимого продолжения.

    % Вопрос вычислимость 10
    \subsection{Область определения вычислимой функции, не имеющей вычислимого тотального продолжения, перечислима, но не разрешима. [R, 32]}

        \begin{proposition}
        Если функция $f$ вычислима, но не имеет вычислимого тотального продолжения, то $\dom f$ --- неразрешимое перечислимое множество.
        \end{proposition}

        \begin{proof}
        Предположим противное: пусть $\dom f$ разрешимо (при этом оно всегда перечислимо --- см. билет 3). Рассмотрим

        \begin{equation*}
        \begin{gathered}
        g(x) =
        \begin{cases}
        f(x), & x \in \dom f \\
        42, & x \notin \dom f \\
        \end{cases}
        \; = \;\chi_{\dom f}(x) \cdot f(x) \,+\, (1 - \chi_{\dom f}(x)) \cdot 42.
        \end{gathered}
        \end{equation*}

        Ясно, что $g$ --- вычислимое тотальное продолжение $f$ --- противоречие. Значит, $\dom f$ неразрешимо и перечислимо.
        \end{proof}

    % Вопрос вычислимость 11
    \subsection{Теорема о рекурсии как следствие теоремы Клини. Пример применения теоремы о рекурсии. [R, 37]}

        Подробнее о теореме Клини --- в 16-м билете.

        \begin{theorem}[о рекурсии]
        Пусть $U$ --- ГУВФ и $V : \NN^2 \to \NN$ вычислима. Тогда $\exists n \in \NN : \; U_n = V_n$.
        \end{theorem}

        \begin{proof}
        Ввиду главности $U$ существует вычислимая тотальная $s : \: \forall k \in \NN \;\; U_{s(k)} = V_k$, а по теореме Клини $\exists n \in \NN : \;\, U_{s(n)} = U_n$. Следовательно, $U_n = V_n$.
        \end{proof}

        Но причем здесь рекурсия? Дело в том, что $V$ можно задать как функцию, зависящую от $U$:

        \begin{itemize}
            \item \begin{example}
                Существование квайнов (программ, выводящих свой текст): $\exists n \in \NN : \; \forall x \; U(n, x) = n$.
            \end{example}

            \begin{proof}
                Функция $V(k, x) = k$ вычислима. По теореме о рекурсии $\exists n \in \NN : \; U(n, x) \simeq V(n, x) = n$.
            \end{proof}

            \item \begin{example}
            Рассмотрим вычислимую функцию

            \begin{equation*}
            \begin{gathered}
            V(k, x) \simeq
            \begin{cases}
            1, & x = 0 \\
            x \cdot U(k, x - 1), & x > 0 \\
            \end{cases}.
            \end{gathered}
            \end{equation*}

            По теореме о рекурсии $\exists n : \; U_n = V_n \implies U(n, 0) = 1$ и $U(n, x) \simeq x \cdot U(n, x - 1)$ при $x > 0$, при этом тотальность $U_n$ доказывается по индукции по $x$. Таким образом, $U(n, x)$ рекурсивно вычисляет факториал второго аргумента.
        \end{example}
        \end{itemize}

        \textbf{Неформально} о смысле теоремы: в главных языках программирования программа может иметь доступ к своему коду, что приводит нас к понятию рекурсии, существование алгоритма для которой гарантирует теорема Клини.

    % Вопрос вычислимость 12
    \subsection{$m$-Сводимость и ее свойства. [R, 52–56]}

        \begin{definition}
        Пусть $A, B \subseteq \NN$. $A \; m$-сводится к $B$ тогда и только тогда, когда существует вычислимая тотальная $f : \NN \to \NN: \; \forall n \; [n \in A \iff f(n) \in B]$. Обозначается как $A \mred B$ или $A \mred^f B$ (если необходимо уточнить функцию сведения). Это определение обобщается на $A \subseteq \NN^n, \; B \subseteq \NN^m$ и $f : \NN^n \to \NN^m$.
        \end{definition}

        Перечислим свойства $m$-сводимости:

        \begin{itemize}
            \item Рефлексивность: $A \mred^{\text{id}_{\NN}} A$

            \item Транзитивность: $A \mred^f B \,\wedge\, B \mred^g C \implies A \mred^{g \circ f} C$

            \item $A \mred^f B \implies \bar A \mred^f \bar B: \;\; n \in \bar A \iff n \notin A \iff f(n) \notin B \iff f(n) \in \bar B \qed$

            \item \textit{Сравнение множеств по алгоритмической сложности:} если $A \mred B$ и $B$ разрешимо (перечислимо), то разрешимо (перечислимо) и $A$.

            \begin{proof}
                $\forall n \;\, \Bigl[\, n \in A \iff \chi_A(n) = 1 \iff \chi_B(f(n)) = 1 \iff f(n) \in B \,\Bigr] \implies \chi_A = \chi_B \circ f$ --- вычислима $\implies A$ разрешимо (аналогично $\omega_A = \omega_B \circ f$).
            \end{proof}

            \item \begin{corollary}
                Если $A \mred B$ и $A$ неразрешимо (неперечислимо), то и $B$ неразрешимо (неперечислимо).
            \end{corollary}
            %\textbf{Следствие.}

            \item Если $A$ разрешимо и $B$ нетривиально $(\void \ne B \ne \NN)$, то $A \mred B$.

            \begin{proof}
            Пусть $b \in B, \, a \in \bar B$, зададим вычислимую $f(n) :=
            \begin{cases}
            b, & n \in A \\
            a, & n \notin A \\
            \end{cases} \implies A \mred^f B$.
            \end{proof}

            \item $\exists A : \; A \not \mred \bar A$. Возьмем $A := \bar K = \NN \wo \dom d$ --- неперечислимое, но $\bar A$ перечислимо --- противоречие сравнению по алгоритмической сложности. $\qed$

            \item $\nexists A : \; \forall B \subseteq \NN \;\, B \mred A$. Одна функция может $m$-сводить к $A$ лишь одно множество, но вычислимых функций счетно, а подмножеств $\NN$ --- несчетно много. $\qed$
        \end{itemize}

    % Вопрос вычислимость 13
    \subsection{Машины Тьюринга (допустимо неформальное определение с лентой и головкой). Сложение натуральных чисел (при унарном и бинарном кодировании) вычислимо по Тьюрингу. [ВШ-3, 9.2]}

        Машина Тьюринга --- устройство, представляющее собой бесконечную ленту, разделенную на ячейки с записанными в них символами, головку, которая движется по ленте и перезаписывает символы в ячейки, и инструкции, оперирующие головкой и задающие некоторый алгоритм.

        Задаются множества $\Gamma$ --- алфавит, символы которого можно использовать при записи в ячейки (в том числе символ пробела <<\verb'#'>>); $\Sigma \subseteq \Gamma$ --- алфавит, в символах которого записан вход (причем \verb'#' $\in \Gamma \wo \Sigma$); $Q$ --- множество состояний, которые принимает головка. Все эти множества обязательно \textbf{конечны}.

        Головка имеет начальное и конечное состояние (обычно они обозначаются как $q_1$ и $q_0$), а также промежуточные состояния, с помощью которых задается алгоритм. Для всех элементов $Q \times \Gamma$ существуют инструкции вида $q c \mapsto q' c' S$. Она означает, что если головка находится в состоянии $q$ и в текущей ячейке записан символ $c$, то головка переходит в состояние $q'$, записывает в текущую ячейку символ $c'$ и сдвигается влево, вправо либо остается на месте ($S \in \{L = \text{<<Left>>}, \, R = \text{<<Right>>}, \, N = \text{<<Neutral>>}\}$). Таким образом, должна быть определена функция инструкций $\delta : Q \times \Gamma \to Q \times \Gamma \times \{N, L, R\}$.

        Для понимания работы машины Тьюринга вводится понятие конфигурации машины --- это строка вида $AqcB$, означающая, что в данный момент на ленте подряд записаны слово $A \in \Gamma^*$, символ $c \in \Gamma$, слово $B \in \Gamma^*$, причем головка находится в состоянии $q$ и указывает на ячейку с символом $c$. Отметим, что, например, $\verb'42'q\verb'195'$ и $\verb'###42'q\verb'195#'$ --- одна и та же конфигурация. На множестве всевозможных конфигураций машины Тьюринга $\mathcal{M}$ задаются отношения $AqcB \underset{\mathcal{M}}{\to} A'q'c'B'$ и $AqcB \underset{\mathcal{M}}{\twoheadrightarrow} A'q'c'B'$, означающие достижимость за один и за сколько угодно шагов работы машины соответственно.

        \bigskip \hrule

        Рассмотрим задачу сложения натуральных чисел. Пусть на вход даны числа $n$ и $m$ в унарном виде, тогда лента будет иметь такой вид:

        $\verb'#####' \underset{\substack{\uparrow \\ q_1 \\}}{\#} \underbrace{11\dots11}_{n}\verb'#'\underbrace{11\dots11}_{m}\verb'######'$

        Тогда для получения суммы $n + m$ достаточно <<склеить>> две последовательности. Поэтому стартуем из начального состояния до пробела, заменяем его на единицу, после чего переходим в новое состояние, доходим до конца записи $m$ и останавливаемся на пробеле. Необходимо перейти в еще одно состояние, чтобы удалить последнюю единицу, после чего дойти до начала входных данных и остановиться.

        Заметим, что если $m = 0$, то добавленная единица будет стерта. При $n = 0$ замена на единицу произойдет также в правильной ячейке ленты.

        В итоге получили такую конфигурацию:

        $\#\#\#\#\#\#\underbrace{11\dots1}_{n}1\underbrace{11\dots\#}_{m}\#\#\#\#\#\#$

        Важно, что кодирование чисел не имеет значения, так как перевод числа в новую кодировку вычислим по Тьюрингу. Вот как двоичная запись превращается в унарную:

        \begin{itemize}
            \item Приходим к концу числа, чтобы вычесть из него единицу;
            \item При вычитании находимся в состоянии <<нужно из разряда слева попросить единицу, в текущем разряде сейчас поменяю 0 на 1 и сдвинусь влево>>;
            \item Так сдвигаемся, пока либо не получили корректный результат (находясь хоть в середине числа), либо до конца числа (это будет значить, что все нули превратились в единицы, то есть произошло переполнение и пора заканчивать алгоритм);
            \item Теперь необходимо добавить единичку в унарное представление числа, для чего идем в правый конец и на место второго пробела записываем единицу (первый же пробел служит разделителем входа и выхода алгоритма);
            \item Снова ищем первый пробел, чтобы вернуться в состояние вычитания;
            \item Завершение алгоритма: когда получили некорректное вычитание, головка окажется слева от входа и выхода. Переходим в новое состояние, чтобы пройтись до первого пробела и стереть на своем пути символы измененного входа. Так перейдем в конечное состояние и получим корректный вывод.
        \end{itemize}

        Таким образом, сложение в унарном и бинарном кодировании вычислимо по Тьюрингу.

    % Вопрос вычислимость 14
    \subsection{Главная универсальная вычислимая функция. Вычислимое биективное кодирование пар натуральных чисел. Построение главной у.в.ф. с помощью произвольной у. в. ф. [R, 22, с. 9--10]}

        \begin{definition}
        Отображение $U : \NN^2 \to \NN$ --- главная универсальная вычислимая функция (ГУВФ), если (а) она вычислима и (б) для любой вычислимой $V : \NN^2 \to \NN$ найдется вычислимая тотальная $s : \NN \to \NN$, такая что $\forall n \in \NN \;\; V_n = U_{s(n)}$.
        \end{definition}

        \textbf{Неформально:} можем рассматривать $V$ как другой язык программирования (от которого не требуется универсальность), а $s$ --- как функцию, преобразующую корректную программу в языке $V$ в эквивалентную в языке $U$.

        \begin{proposition}
            Если $U$ --- ГУВФ, то $U$ --- УВФ.
        \end{proposition}

        \begin{proof}
            Рассмотрим произвольную вычислимую функцию $f$, для которой хотим найти номер $n$ ее сечения в $U$. Введем $V : \NN^2 \to \NN$, такую что каждое ее сечение совпадает с $f$. Ввиду главности $U$ существует вычислимая тотальная $s: \: \forall k \in \NN \;\; U_{s(k)} = V_k$. Тогда за $n$ можно взять любой элемент из $\rng s$, например, $n := s(42) \implies f = V_{42} = U_{s(42)} = U_n$. Следовательно, $U$ обладает свойством универсальности.
        \end{proof}

        \begin{proposition}
        Если существует УВФ, то существует и ГУВФ.
        \end{proposition}

        \begin{proof}
        Зафиксируем УВФ $U$ и введем кодирование пар, для этого рассмотрев любую вычислимую биекцию $h : \NN^2 \to \NN$ $\left( \text{например, } h(n, m) = \frac{(n + m)(n + m + 1)}{2} + n \right)$. Пусть код пары --- функция $\pair{n, m} := h(n, m)$, а также $\pi^1(\pair{n, m}) = n$ и $\pi^2(\pair{n, m}) = m$ (они вычислимы, так как можем перечислить $\NN^2$ и найти единственную подходящую пару).

        Рассмотрим $W : \NN^2 \to \NN$, такую что $\forall n \, \forall x \;\, W(n, x) \simeq U(\pi^1(n), \pair{\pi^2(n), x})$ --- вычислима как композиция вычислимых функций. Установим свойство главности для $W$.

        Пусть $V : \NN^2 \to \NN$ --- произвольная вычислимая функция, а $V' : \NN \to \NN$, такая что $V'(x) \simeq V(\pi^1(x), \pi^2(x))$ --- тоже вычислима. Тогда $\exists \, m \in \NN : \; U_m = V'$. Положим $s(n) := \pair{m, n}$ --- вычислимая тотальная.

        Далее,

        \begin{equation*}
        \begin{gathered}
        \forall n \, \forall x \;\; W\bigl(s(n), \, x\bigr) \simeq W\bigl(\pair{m, n}, \, x\bigr) \simeq U\bigl(\pi^1(\pair{m, n}), \, \bigl\langle \pi^2(\pair{m, n}), \, x \bigr\rangle \bigr) \simeq U\bigl(m, \, \pair{n, x}\bigr) \simeq U_m\bigl(\pair{n, x}\bigr) \simeq
        \\
        \simeq V'\bigl(\pair{n, x}\bigr) \simeq V\bigl(\pi^1(\pair{n, x}), \, \pi^2(\pair{n, x})\bigr) \simeq V(n, x) \implies \forall n \in \NN \;\; W_{s(n)} = V_n \implies W \text{ --- ГУВФ}
        \end{gathered}
        \end{equation*}
        \end{proof}

        При этом УВФ, не являющаяся главной --- <<объект в некотором роде экзотический>>, хотя ее существование доказывается в билете 21.

    % Вопрос вычислимость 15
    \subsection{Невозможность универсальной вычислимой тотальной функции. [?, 9.15], [ВШ-3, 2.2, т. 8]}

        \begin{proposition}
        Не существует универсальной вычислимой тотальной функции $W$.
        \end{proposition}

        \begin{proof}[Парадокс самоприменимости.]
        Пусть $d : \NN \to \NN$ --- диагональная функция $W: \; d(x) = W(x, x)$. Заметим, что $d$ вычислима и тотальна из существования этих свойств у $W$. Введем также $g(x) = d(x) + 1$, которая по тем же причинам вычислима и тотальна.

        $W$ универсальна, следовательно $\exists m \in \NN : W_m = g \implies W(m, x) = g(x) \; \forall x \in \NN$. Возьмем $x = m$ и тогда получим $W(m, m) = g(m) = d(m) + 1 = W(m, m) + 1 \implies 0 = 1$ --- противоречие $\implies$ УВТФ не существует.
        \end{proof}

        Заметим, что так же <<доказать>> несуществование УВФ $U$ не получится, так как запись $U(m, m) \simeq U(m, m) + 1$ как раз имеет место, если на этих аргументах функция не определена.

    % Вопрос вычислимость 16
    \subsection{Теорема Клини о неподвижной точке. [R, 36]}

        \begin{theorem}[Клини о неподвижной точке]
            Пусть $U$ --- ГУВФ. Тогда для любой вычислимой тотальной $f : \NN \to \NN \;\; \exists n \in \NN : \;\, U_{f(n)} = U_n$.
        \end{theorem}

        \textbf{Неформально:} в главном языке программирования $U$ никакое алгоритмическое преобразование программ $f$ не меняет смысл всех программ разом.

        \begin{proof}
            Рассмотрим $V : \NN^2 \to \NN$, такую что $\forall k \, \forall x \;\, V(k, x) \simeq U\bigl( U(k, k), \, x \bigr)$ --- вычислима как композиция вычислимых, откуда из главности $U$ существует вычислимая тотальная $s : \NN \to \NN$, такая что $U_{s(k)} = V_k = U_{U(k, k)} \; \forall k \in \NN$.

            Теперь берем произвольную $f$ из формулировки теоремы. $f \circ s$ вычислима тотальна $\implies \exists t : \, U_t = f \circ s \implies U(t, t) = f(s(t))$, тогда $U_{s(t)} = U_{U(t, t)} = U_{f(s(t))}$. Тогда для $f$ найдется $n = s(t)$, такое что $U_{f(n)} = U_n$.
        \end{proof}

        <<Более интуитивное>> доказательство есть в учебнике Верещагина.

    % Вопрос вычислимость 17
    \subsection{Индексные множества. Теорема Райса-Успенского: вывод из теоремы Клини. [R, 48] Пример применения.}

        Пусть $\mathcal{F}$ --- семейство вычислимых функций одного аргумента. Назовем его индексным множеством относительно ГУВФ $U$ множество $F = \{ n \in \NN \mid U_n \in \mathcal{F} \}$.

        \begin{theorem}[Райса-Успенского]
            Если семейство $\mathcal{F}$ вычислимых функций нетривиально (то есть $\void \ne F \ne \NN$), то его индексное множество $F$ относительно любой ГУВФ неразрешимо.
        \end{theorem}

        \textbf{Неформально:} множество программ, которые вычисляют функцию с какоим-то нетривиальным свойством, неразрешимо. \textbf{Еще проще:} по номеру программы нельзя наперед узнать, обладает ли она нетривиальным свойством. Например, где-то определена или монотонно возрастает на своей области определения.

        \begin{proof}[Доказательство (Есенина-Вольнина)]
        Пусть $f \in \mathcal{F}$ и $g \notin \mathcal{F}$ вычислимы. Ввиду универсальности $U \; \exists n \, \exists m : \; f = U_n$ и $g = U_m$.

        Предположим противное: пусть $F$ разрешимо, тогда вычислима тотальная функция

        \begin{equation*}
        \begin{gathered}
        h(k) =
        \begin{cases}
        m, & k \in F \\
        n, & k \notin F \\
        \end{cases}.
        \end{gathered}
        \end{equation*}

        В таком случае можно применить теорему Клини: $\exists \, t : \; U_t = U_{h(t)}$. Рассмотрим два случая:

        \begin{itemize}
            \item $t \in F \implies U_t = U_{h(t)} \in \mathcal{F} \implies h(t) = m \implies U_m = g \in \mathcal{F}$ --- противоречие.

            \item $t \notin F \implies U_t = U_{h(t)} \notin \mathcal{F} \implies h(t) = n \implies U_n = f \notin \mathcal{F}$ --- противоречие.
        \end{itemize}

        Следовательно, множество $F$ неразрешимо.
        \end{proof}

    % Вопрос вычислимость 18
    \subsection{Индексные множества. Теорема Райса-Успенского: доказательство с помощью сведения. [R, 47] Пример применения.}

        Все формулировки в предыдущем билете.

        \begin{proof}[Доказательство (Райса)]
            Пусть $\xi \notin \mathcal{F} \implies \exists f \in \mathcal{F}: \; f \ne \xi$. Рассмотрим любое перечислимое неразрешимое $K$ и вычислимую $V(n, x) \simeq f(x) \cdot \omega_K(n)$. Из главности $U$ следует существование вычислимой тотальной $s : \; U_{s(n)} = V_n$. Рассмотрим два случая:

            \begin{itemize}
                \item $n \in K \implies V_n = f \in \mathcal{F} \implies U_{s(n)} \in \mathcal{F} \implies s(n) \in F$

                \item $n \notin K \implies V_n = \xi \notin \mathcal{F} \implies U_{s(n)} \notin \mathcal{F} \implies s(n) \notin F$
            \end{itemize}

            Получили, что $n \in K \iff s(n) \in F \implies K \mred^s F$, причем $K$ неразрешимо, поэтому неразрешимо и $F$ (по свойствам $m$-сводимости, билет 12).

            Пусть теперь $\xi \in \mathcal{F}$. Тогда просто применим такое же доказательство к множеству $\bar F$ и получим тот же результат.
        \end{proof}

    % Вопрос вычислимость 19
    \subsection{Пример неперечислимого множества с неперечислимым дополнением. [R, 61 или 64]}

        Пусть $U$ --- ГУВФ. Докажем, что множество $Z = \{n \in \NN \mid \dom U_n = 2\NN \}$ и $\bar Z$ неперечислимы (задача 4c домашнего задания №3).

        Пусть $K$ --- неразрешимое перечислимое множество, откуда $\bar K$ неперечислимо по теореме Поста (билет 2). Введем две функции:

        \begin{equation*}
        \begin{gathered}
        V(n, x) \simeq
        \begin{cases}
        1, & n \in K \cap x \divby 2 \\
        \udv, & \text{иначе} \\
        \end{cases}
        \text{ --- вычислима как } \omega_{K}(n) \text{ с дополнительной проверкой четности } x
        \\[6 pt]
        \text{Тогда из главности } U \;\; \exists s: \; \forall n \in \NN \;\;\; U_{s(n)} = V_n \implies
        \\
        \implies \Bigl[\; n \in K \iff \dom V_n = 2\NN \iff \dom U_{s(n)} = 2\NN \iff s(n) \in Z \;\Bigr] \implies
        \\
        \implies K \mred^s Z \implies \bar K \mred \bar Z \implies \bar Z \text{ неперечислимо по свойствам $m$-сводимости.}
        \\[10 pt]
        V'(n, x) \simeq
        \begin{cases}
        1, & n \in K \cup x \divby 2 \\
        \udv, & \text{иначе} \\
        \end{cases}, \;\; \text{аналогично} \;\, \exists s': \; \forall n \in \NN \;\;\; U_{s'(n)} = V'_n \implies
        \\[4 pt]
        \implies \Bigl[\; n \in K \iff \dom V'_n \ne 2\NN \iff \dom U_{s'(n)} \ne 2\NN \iff s'(n) \notin Z \iff s'(n) \in \bar Z \;\Bigr] \implies
        \\
        \implies K \mred^{s'} \bar Z \implies \bar K \mred Z \implies Z \text{ неперечислимо по свойствам $m$-сводимости.}
        \end{gathered}
        \end{equation*}

    % Вопрос вычислимость 20
    \subsection{Пример непересекающихся перечислимых множеств, не отделимых никаким разрешимым множеством. [R, 34], [G, с. 21–22]}

        Пусть $A, B \subseteq \NN$. Множество $C \subseteq \NN$ отделяет $A$ от $B$, если $A \subseteq C$ и $B \subseteq \bar C$.

        \begin{proposition}
        Существуют перечислимые множества $A$ и $B$, не отделимые никаким разрешимым множеством.
        \end{proposition}

        \begin{proof}
        Зафиксируем УВФ $U$ и ее диагональ $d$. Зададим вычислимую функцию

        \begin{equation*}
        \begin{gathered}
        f(x) \simeq
        \begin{cases}
        0, & x \in \dom d \,\wedge\, d(x) > 0 \\
        1, & x \in \dom d \,\wedge\, d(x) = 0 \\
        \udv, & x \notin \dom d \\
        \end{cases}.
        \end{gathered}
        \end{equation*}

        Заметим, что у $f$ не существует вычислимого тотального продолжения, так как $\plot_f \cap \plot_d = \void$ (см. билет 9).

        Положим $A = f^{-1}(1), \; B = f^{-1}(0)$ --- перечислимы как прообразы перечислимых множеств под действием вычислимой функции $f$ (билет 3). Пусть также $C$ разрешимо и отделяет $A$ от $B$. Тогда $x \in A \implies \chi_C(x) = 1 = f(x), \;\;\; x \in B \implies \chi_C(x) = 0 = f(x)$, при этом $A \cup B = \dom f$, следовательно $\forall x \in \dom f \;\; f(x) = \chi_C(x) \implies \chi_C$ --- тотальное продолжение $f \implies \chi_C$ невычислима $\implies C$ неразрешимо.
        \end{proof}

    % Вопрос вычислимость 21
    \subsection{Существование неглавной у. в. ф. [R, 49]}

        \begin{proposition}
            Существует \textbf{не}главная УВФ.
        \end{proposition}

        \begin{proof}
        Пусть $U$ --- ГУВФ, а множество $Z = \{n \in \NN \mid U_n = \xi\}$. Тогда его дополнение

        \begin{equation*}
        \begin{gathered}
        \bar Z \,=\, \{n \in \NN \mid U_n \ne \xi\} \,=\, \{n \in \NN \mid \exists x : \; U_n(x) \text{ определено}\} \,=\, \{n \in \NN \mid \exists x \, \exists k : \; T(n, x, k)\}
        \end{gathered}
        \end{equation*}

        перечислимо как проекция разрешимого $T$, откуда существует вычислимая $f : \NN \to \NN$, такая что $\rng f = \bar Z$ (эквивалентное определение перечислимости, см. билет 4). При этом $Z$ неперечислимо, иначе по теореме Поста $Z$ было бы разрешимым (билет 2), что невозможно по теореме Райса-Успенского (билет 17).

        Зададим функцию двух аргументов
        \begin{equation*}
        \begin{gathered}
        W(n, x) \simeq
        \begin{cases}
        \udv, & n = 0 \\
        U(f(n - 1), x), & n \ne 0 \\
        \end{cases}.
        \end{gathered}
        \end{equation*}

        $W$ вычислима как композиция вычислимых функций, а также универсальна: \: если вычислимая $g$ равна $\xi$, то ее номер в $W$ --- ноль, иначе $g = W_{f^{-1}(k) + 1}$, где $g = U_k$. Получили $Z' = \{n \in \NN \mid W_n = \xi\} = \{0\}$, то есть в языке программирования $W$ у нигде не определенной функции есть только одна вычисляющая ее программа с номером 0. $Z'$ --- разрешимое индексное множество нетривиального семейства вычислимых функций, поэтому $W$ --- неглавная УВФ, иначе не выполняется теорема Райса-Успенского (билет 17).
        \end{proof}

    % Вопрос вычислимость 22
    \subsection{Бесконечность множества неподвижных точек в смысле теоремы Клини. [R, 45]}

        \begin{proposition}[семинарская задача 3.7]
            Пусть $U$ --- ГУВФ и $f : \NN \to \NN$ вычислима. Тогда множество неподвижных точек $X = \{n \in \NN \mid U_n = U_{f(n)}\}$ бесконечно.
        \end{proposition}

        \begin{proof}
            Предположим противное: пусть $X$ конечно, а значит и разрешимо. Так как вычислимых функций бесконечно много, то найдется такая $g : \NN \to \NN$, что ее индексное множество $\{n \in \NN \mid U_n = g\}$ не пересекается с $X$. Пусть $U_m = g$. Введем функцию

            \begin{equation*}
            \begin{gathered}
            h(n) =
            \begin{cases}
            m, & n \in X \\
            f(n), & n \notin X \\
            \end{cases}
            \end{gathered}
            \end{equation*}

            Она вычислима и тотальна в силу этих свойств у $f$ и $\chi_X$. Тогда по теореме Клини $\exists n \in \NN : \; U_n = U_{h(n)}$.

            \begin{itemize}
                \item $n \in X$: \; тогда $h(n) = m \ne n$, так как $m \notin X$. Получаем, что $U_n = U_m = g \implies n \notin X$ --- противоречие.

                \item $n \notin X$: \; тогда $U_n = U_{f(n)} \implies n \in X$ --- противоречие.
            \end{itemize}

            Получаем, что множество неподвижных точек для произвольных УВФ и ВФ бесконечно.
        \end{proof}

    % Вопрос вычислимость 23
    \subsection{Вычислимость индекса композиции вычислимых функций. [R, 42] Совместная рекурсия: решение «систем уравнений». [R, 43]}

        \begin{proposition}
            Если $U$ --- ГУВФ, то существует вычислимая тотальная $c$, такая что $\forall p, \, q \in \NN \;\; U_{c(p, q)} = U_p \circ U_q$.
        \end{proposition}

        \textbf{Неформально:} зная тексты программ $p$ и $q$, можно автоматически сгенерировать программу, вычисляющую их композицию.

        \begin{proof}
            Достаточно ввести функцию $V(n, x) \simeq U\bigl(\pi^1(n), \, U\bigl(\pi^2(n), x\bigr)\bigr)$, вычислимую как композицию вычислимых. Ввиду главности $U$ существует вычислимая тотальная $s: \; \forall n \in \NN \;\; U_{s(n)} = V_n$. Зададим $c(x, y) := s(\pair{x, y})$. Тогда имеем

            \begin{equation*}
            \begin{gathered}
            \forall p \, \forall q \, \forall x \;\; U_{c(p, q)}(x) \simeq U_{s(\pair{p, q})}(x) \simeq V_{\pair{p, q}}(x) \simeq U\bigl(\pi^1(\pair{p, q}), \, U\bigl(\pi^2(\pair{p, q}), x\bigr)\bigr) \simeq U\bigl(p, \, U(q, x)\bigr) \simeq \bigl(U_p \circ U_q\bigr)(x)
            \end{gathered}
            \end{equation*}
        \end{proof}

        \begin{theorem}[о совместной рекурсии]
            Пусть $U$ --- ГУВФ, а $V_1, V_2 : \NN^3 \to \NN$ вычислимы. Тогда

            \begin{equation*}
            \begin{gathered}
            \exists a, \, \exists b : \; \forall x \;
            \begin{cases}
            U(a, x) \simeq V_1(a, b, x) \\
            U(b, x) \simeq V_2(a, b, x) \\
            \end{cases}
            \end{gathered}
            \end{equation*}
        \end{theorem}


\section{Вопросы по логике}

    % Вопрос логика 1
    \subsection{Структуры и сигнатуры. Нормальные структуры. Изоморфизм структур. [MD]}
    \begin{definition}
        Сигнатурой называется тройка множеств $\sigma = (\text{Rel}, \text{Func}, \text{Const})$,
        где Rel --- символы отношений (предикаты), Func --- функциональные символы,
        Const --- символы констант. Также мы считаем, что каждому $R \in \text{Rel}$
        приписано число $n \in \mathbb{N}$ --- валентность символа (арность, местность).
        Используется как $R^{(n)}$. Эта запись означает, что символ отношения
        принимает $n$ аргументов. Аналогично вводится валентность для функциональных символов.
    \end{definition}

    Давайте теперь отдельно отметим, что у нас есть общее для всех сигнатур:
    \begin{itemize}
        \item алфавит переменных: счётное множество $\text{Var} = \{v_0, v_1, v_2, \dots\}$.
        \textit{Соглашение:} по умолчанию, разные буквы $x, y, z$ и т.д. 
        обозначают разные $v_i$.
        \item символы связок: $\land, \lor, \implies, \neg, \iff$
        \item кванторы: $\exists, \forall$
        \item скобки: (, )
    \end{itemize}

    И что теперь со всем этим делать?

    Например в какой-нибудь сигнатуре $\sigma = (=^{(2)}; +^{(2)}; 2)$ мы можем записать выражение типа
    $2 + x = 2$. Но что такое 2? И что подставлять вместо $x$? Допустим, что в переменные подставляются
    элементы некого множества $M$. Но тогда нам надо уметь сложить 2 и элемент из $M$, а значит и сама
    2 должна быть элементом этого множества, знак ''+'' надо понимать как функцию на множестве $M$, а 
    ''='' как отношение на нём. Но тогда надо вообще все константы понимать как элементы множества $M$,
    символы отношений как отношения на нём, а фукциональные символы как функции. Но какие? Ответом является
    \textbf{структура сигнатуры}.

    Чтобы понять, как именно нам надо работать с нашей сигнатурой, нам надо придать смысл всем её элементам:
    символам констант, отношений и функций, ведь сами по себе смысла они не несут (кроме, разве что, валентности).

    Придачей смысла сигнатуре занимается
    \begin{definition}
        \textbf{Интепретация сигнатуры $\sigma$} --- это пара $\mathcal{M} = (M, I_\mathcal{M})$,
        где $M \neq \varnothing$, а $I_\mathcal{M}$ --- это такое отображение, что
        \begin{enumerate}
            \item $\forall R^{(n)} \in \text{Rel}_\sigma \quad I_{\mathcal{M}}(R) \subseteq M^{n}$, 
            то есть $I_{\mathcal{M}}(R)$ --- это $n$-арное отношение на $M$;
            \item $\forall f^{(m)} \in \text{Func}_\sigma \quad I_{\mathcal{M}}(f) \colon M^{m} \to M$;
            \item $\forall c \in \text{Const}_\sigma \quad I_{\mathcal{M}}(c) \in M$.
        \end{enumerate}
        Множество $M$ называется {\it носителем интерпретации} $\mathcal{M}$.
    \end{definition}

    \paragraph{Пример}
    Рассмотрим сигнатуру $\sigma = (\text{Rel}_{\sigma} = \{ Q^{(3)} \}; \text{Func}_{\sigma} = \{ f^{(2)}, \#^{(1)} \}; \text{Const}_{\sigma} = \{ \$ \})$ и две ее интерпретации
    \[
        \mathcal{M} = ( \{ 0, 1 \}; Q^{\mathcal{M}}; f^{\mathcal{M}}, \#^{\mathcal{M}}; \$^{\mathcal{M}}),
    \]
    где 
    \begin{align}
        &Q^{\mathcal{M}} \subseteq \{0, 1\}^{3} \colon (x, y, z) \in Q^{\mathcal{M}} \iff x = y = z \implies Q^{\mathcal{M}} = \{ (0, 0, 0), (1, 1, 1)\}; \\
        &f^{\mathcal{M}}(x, y) = x \oplus y, \quad \#^{\mathcal{M}}(x) = x; \\
        &\$^{\mathcal{M}} = 1.
    \end{align}
    Мы получили какую-то интерпретацию $\sigma$.
    Какого-то особого смысла в ней нет, но как пример она вполне себе подойдет.

    Можно рассмотреть и другую интерпретацию $\mathcal{N} = (\NN; Q^{\mathcal{N}}; f^{\mathcal{N}}, \#^{\mathcal{N}}; \$^{\mathcal{N}})$:
    \begin{align}
        &(x, y, z) \in Q^{\mathcal{N}} \iff x + y = z; \\
        &f^{\mathcal{N}}(x, y) = (x \cdot y)^{2}, \quad \#^{\mathcal{N}}(x) = x + 7; \\
        &\$^{\mathcal{N}} = 2020.
    \end{align}
    В ней также нет ничего содержательного, просто она отличается от $\mathcal{M}$.

    Также существует понятие \textit{нормальной} структуры. Под ним понимается структура, в которой
    знак ''='' означает именно равенство элементов в нашем обыденном понимании, то есть 
    $\text{id}_M = \{(a, a) \mid a \in M\}$

    Теперь поговорим об уже знакомом нам понятии изоморфизма.

    \begin{definition} \label{def::isomorphism-on-structures}
        Будем говорить, что $\alpha$ --- {\it изоморфизм} между $\mathcal{M}$ и $\mathcal{N}$, если
        \begin{enumerate}
            \item $\alpha \colon M \to N$ --- биекция;
            \item Сохраняются все отношения, то есть $\forall R^{(n)} \in \text{Rel}_{\sigma}$, $\forall \vec{a} \in M^{n}$ $R^{\mathcal{M}}(\vec{a}) \iff R^{\mathcal{N}}(\alpha \vec{a})$;
            \item ''Уважаются'' все функции, то есть $\forall f^{(n)} \in \text{Func}_{\sigma}$, $\forall \vec{a} \in M^{n}$ $\alpha f^{\mathcal{M}}(\vec{a}) = f^{\mathcal{N}}(\alpha \vec{a})$;
            \item $\forall c \in \text{Const}_{\sigma}$, $\alpha c^{\mathcal{M}} = c^{\mathcal{N}}$;
        \end{enumerate}
    \end{definition}
    
    \begin{definition}
        Будем говорить, что структуры $\mathcal{M}$ и $\mathcal{N}$ изоморфны (обозн. $\mathcal{M} \cong \mathcal{N}$), если существует изоморфизм $\alpha \colon \mathcal{M} \to \mathcal{N}$.
    \end{definition}
    
    \begin{proposition}
        \begin{enumerate}
            \item $\mathcal{M} \overset{\text{Id}_{\mathcal{M}}}{\cong} \mathcal{M}$.
            \item $\mathcal{M} \overset{\alpha}{\cong} \mathcal{N} \implies \mathcal{N} \overset{\alpha^{-1}}{\cong} \mathcal{M}$.
            \item $\mathcal{M} \overset{\alpha}{\cong} \mathcal{N}$ и $\mathcal{N} \overset{\beta}{\cong} \mathcal{L} \implies \mathcal{M} \overset{\beta \circ \alpha}{\cong} \mathcal{L}$.
        \end{enumerate}
    \end{proposition}~
    \begin{example}
    Рассмотрим конкретный пример, который является классическим.
    Положим $\mathcal{M} = \left( \mathbb{R}; =; +^{(2)}; 0 \right)$ и $\mathcal{N} = \left( R_{+}; =; \cdot^{(2)}; 1 \right)$.
    Естественно, это интерпретация одной сигнатуры $\sigma = \left( =; \circ^{(2)}; e \right)$.
    \end{example}
    % Вопрос логика 2
    \subsection{Формулы первого порядка данной сигнатуры. Параметры (свободные переменные) формулы. Предложения. [F, с. 1–2]}
    Мы навводили всяких сигнатур и структур, но вопрос что нам с ними делать. Писать в них
    математические формулы, конечно! Но для начала разберёмся с термами, из которых строятся формулы.

    \begin{definition}
        \textbf{Терм в сигнатуре $\sigma$}. $\text{Tm}_\sigma$ --- множество термов в $\sigma$
        \begin{itemize}
            \item $x \in \text{Var} \implies x \in \text{Tm}_\sigma$
            \item $c \in \text{Const} \implies c \in \text{Tm}_\sigma$
            \item $f^{(m)} \in \text{Func}_\sigma, t_1, \dots, t_m \in \text{Tm}_\sigma
            \implies f t_1 \dots f_m \in \text{Tm}_\sigma$. (Тут мы воспользовались префиксной 
            польской записью).
        \end{itemize}
    \end{definition}

    \begin{example}
        \textbf{Термы в арифметике}

        2 --- терм, $x$ --- терм, значит $(2 + x)$ --- терм, значит $(2 + x)++$ --- терм.

        3 --- терм, $z$ --- терм, значит $(3 \cdot z)$ --- терм, значит $(y + (3 \cdot z))$ --- терм.
    \end{example}

    Термы готовы, определим формулы.

    \begin{definition}
        \textbf{Формулы в сигнатуре $\sigma$} $\text{Fm}_\sigma$ --- множество формул.
        \begin{itemize}
            \item $R^{(n)} \in \text{Rel}, t_1, \dots, t_n \in \text{Tm} \implies  \in \text{Fm}$
            \item $\varphi, \psi \in \text{Fm} \implies (\varphi \land \psi), (\varphi \lor \psi),
            (\varphi \implies \psi), (\varphi \iff \psi), \neg \varphi \in \text{Fm}$
            \item $x \in \text{Var}, \varphi \in \text{Fm} \implies \exists x \varphi, \forall x \varphi
            \in \text{Fm}$
        \end{itemize}
    \end{definition}

    \begin{example}
        \textbf{Формулы в арифметике}

        $(2 + x)++$ --- терм, $(y + 3 \cdot z)$ --- терм, а значит $(2 + x)++ < y + 3 \cdot z$ ---
        формула. А значит $\neg((2 + x)++ < y + 3 \cdot z)$ --- формула, а значит $\forall w \neg((2 + x)++ < y + 3 \cdot z)$
        --- формула, а значит $\forall w \neg((2 + x)++ < y + 3 \cdot z) \implies (x + 3)$ --- формула,
        т.к. $(x + 3)$ --- терм, и так далее.
    \end{example}

    В данном случае мы получили формулы первого порядка, по той причине что мы оперируем лишь конкретными
    элементами. Если бы мы работали с подмножествами, то это были бы уже формулы второго порядка, чем
    мы тут пока не занимаемся.

    \begin{definition}[свободная переменная]
        Зафиксируем функцию $\text{FV} \colon \text{Fm}_{\sigma} \to \text{Var}$, которая каждой формуле ставит в 
        соответствие множество {\it свободных} переменных в ней, следующим образом:
        \begin{enumerate}
            \item $\text{FV}(R t_{1} \ldots t_{n}) = V(t_{1}) \cup \ldots \cup V(t_{n})$.
            \item $\text{FV}(\phi \land \psi) =\text{FV}(\phi \lor \psi) = \ldots =\text{FV}(\phi) \cup\text{FV}(\psi)$.
            \item $\text{FV}(\forall x~\phi) =\text{FV}(\exists x~\phi) =\text{FV}(\phi) \setminus \{x\}$.
        \end{enumerate}
    \end{definition}

    Человеческим языком: под свободной переменной (или параметром) формулы понимается та переменная(ые),
    не связанные квантором. Важно понимать, что в одну и ту же формулу $x$ может иметь как свободное 
    вхождение, так и связанное, например
    \[
        x = 3 \quad \lor \quad \exists x~x + 2 = 1.
    \]
    Здесь первый $x$ имеет свободное вхождение, а второй $x$ --- связанное.
    Получается, что хоть обозначение и одно, вхождения разные, ведь в первом случае что-то говорится 
    про конкретный объект $x$, конкретное число, а во втором случае что-то говорится про всю область 
    наших чисел (что среди них имеется решение нашего уравнения).
    То есть это, по сути дела, разные $x$, и их возможное совпадение может считаться случайным.

    \begin{definition}
        \textbf{Предложением} называется формула, которая не содержит свободных переменных.
    \end{definition}
    % Вопрос логика 3
    \subsection{Оценка переменных. Значение терма и формулы в данной структуре при данной оценке. [F, с. 2–3] Независимость значения формулы от значений переменных, не являющихся ее параметрами. [F, 5]}
    \underline{Напоминание:} Переменные -- это какие-то символы (различимые) 
    $Var = \{v_0, v_1, \ldots, v_n, \ldots\} ∼ ℕ$ (то есть, их счётно много).
    \begin{definition}[Оценка переменных]
        Оценка переменных в интерпретации $\mathcal{M}$ -- это любая функция
        $\pi: Var → M$.
    \end{definition}
    \begin{example}
        Всем переменным с чётными номерами поставим в соответствие 5, а
        всем переменным с нечётными -- их номер. 
        Получится оценка переменных в любой интерпретации, где носителем 
        выступают натуральные числа.  
    \end{example}
    \underline{Обозначения:} Значение терма $t ∈ Tm_{\sigma}$ в интерпретации
    $\mathcal{M}$ при оценке $\pi$ $: [t]_{\mathcal{M}}(\pi) ∈ M$ 
    (иногда $\mathcal{M}$ можно опускать, если и так понятно, какая 
    интерпретация).
    \begin{definition}[Значение терма $t ∈ Tm_{\sigma}$ в интерпретации
        $\mathcal{M}$ при оценке $\pi$] \ \\
        Индукция по построению:  
        \begin{itemize}
            \item[(1)] $ t = x ∈ Var ⇒ [x]_{\mathcal{M}}(\pi) = \pi(x)$
            \item[(2)] $c ∈ Const ⇒ [c]_{\mathcal{M}}(\pi) = c^{\mathcal{M}}$
            (константе в интерпретации уже приписано некое значение)
            \item[(3)] $[ft_1\ldots t_m]_{\mathcal{M}}(\pi) = 
            f^{\mathcal{M}}([t_1]_{\mathcal{M}}(\pi), \ldots, 
            [t_m]_{\mathcal{M}}(\pi))$  
        \end{itemize}
    \end{definition}
    \begin{example}
        Вернёмся к нашей интерпретации $\mathcal{N}$ из предыдущих билетов. \\[9.5pt]
        $[f(\#  x)x]_{\mathcal{N}}(\pi) =
        f^{\mathcal{N}}([\# x]_{\mathcal{N}}(\pi), 
        [x]_{\mathcal{N}}(\pi)) =
        f^{\mathcal{N}}(\#^{\mathcal{N}}([x]_{\mathcal{N}}(\pi)), 
        [x]_{\mathcal{N}}(\pi)) =
        f^{\mathcal{N}}(\#^{\mathcal{N}}(\pi(x)), \pi(x))$ \\[9.5pt]
        Допустим наша оценка оценила $x$ числом 9 ($\pi(x) = 9$). Тогда 
        $[f(\#  x)x]_{\mathcal{N}}(\pi) = ((9 + 7) \cdot 9)^2 = (16 \cdot 9)^2 ∈ \mathbb{N}$
    \end{example}
    \begin{lemma}
        Если $∀ x ∈ V(t) \pi_1(x) = \pi_2(x)$, то 
        $[t]_{\mathcal{M}}(\pi_1) = [t]_{\mathcal{M}}(\pi_2)$. \\
        Доказательство в билете не просят,
         но доказывается индукцией по построению.
    \end{lemma}
    \underline{Обозначения:} Значение формулы $\varphi ∈ Fm_{\sigma}$ в интерпретации
    $\mathcal{M}$ при оценке $\pi$ $: [\varphi]_{\mathcal{M}}(\pi) ∈ \{0, 1\}$ (ложь/истина) \\
    \begin{definition}[Модифицированная оценка] \ \\
        Пусть $\pi: Var → M$ \\
        Пусть $y ∈ Var$ и $m ∈ M$ \\
        $(\pi+(y ↦ m)): Var → M$ (альтернативное обозначение: 
        $\pi_y^m$) называется модифицированной оценкой\\
        $\pi_y^m(x) = \begin{cases}
            m , x \eqcirc y \text{(x то же самое, что и у, алфавитно)} \\
            \pi(x), x \not \eqcirc y
        \end{cases}$ 
    \end{definition}
    \begin{definition}[Значение формулы $\varphi ∈ Fm_{\sigma}$ в интерпретации
        $\mathcal{M}$ при оценке $\pi$] \ \\
        Индукция по построению:
        \begin{itemize}
            \item[(1)] (атомарная формула) 
            $[Rt_1, \ldots, [t_n]_{\mathcal{M}}(\pi) = $
            $\begin{cases}
                1, ([t_1]_{\mathcal{M}}(\pi), \ldots, 
                [t_n]_{\mathcal{M}}(\pi) ∈ R^{\mathcal{M}} \\
                0, \text{ иначе}
            \end{cases}$
            \item[(2)] (логические связки) 
            $[\varphi ∧ \psi]_{\mathcal{M}}(\pi)$ = 
            И$([\varphi]_{\mathcal{M}}(\pi), [\psi]_{\mathcal{M}}(\pi))$.
            Аналогично для ИЛИ, СЛЕДОВАНИЯ, ЭКВИВАЛЕНТНОСТИ и НЕ
            \item[(3)]
            $[∀ x \varphi](\pi) =
            \begin{cases}
                1, \text{для всех } m ∈ M [\varphi](\pi_x^m) = 1\\
                0, \text{иначе}
            \end{cases}$ \\ 
            $[∃ x \varphi](\pi) =
            \begin{cases}
                1, \text{существует } m ∈ M [\varphi](\pi_x^m) = 1\\
                0, \text{иначе}
            \end{cases}$
        \end{itemize}
    \end{definition}
    \begin{example}
        Вернёмся к нашей интерпретации $\mathcal{N}$ из предыдущих билетов. \\[9.5pt]
        $\varphi = ∃ x ∀ y Qxyy$ (это замкнутая формула -- в ней нет свободных
        переменных) \\[9.5pt]
        $[∃ x ∀ y Qxyy](\pi) = 1 ⇔ ∃ a ∈ \mathbb{N} [∀ y Qxyy](\pi_x^a) = 1
        ⇔  ∃ a ∈ \mathbb{N}, ∀ b ∈ \mathbb{N} [Qxyy](\pi^{ab}_{xy})
        ⇔ [x](\pi^{ab}_{xy}) + [y](\pi^{ab}_{xy}) = [y](\pi^{ab}_{xy})
        ⇔ \pi_x^a(x) + \pi_y^b(y) = \pi_y^b(y)$ (этот шаг по лемме) 
        $⇔ a + b = b$ \\[9.5pt]
        В нашей интерпретации значение формулы действительно истина (
            $a$ возьмём нулём
        )   
    \end{example}
    \begin{lemma}
        Если $∀ y ∈ FV(\varphi) \pi_1(y) = \pi_2(y)$, то 
        $[\varphi]_{\mathcal{M}}(\pi_1) = [\varphi]_{\mathcal{M}}(\pi_2)$
    \end{lemma}
    \begin{proof}
        Индукция по построению: 
        \begin{itemize}
            \item[(1)] $\varphi \eqcirc Rt_1, \ldots, t_n$\\
            $FV(Rt_1, \ldots, t_n) = V(t_1) ∪ \ldots  ∪ V(t_n) ⇒
            V(t_i) ⊆ FV(Rt_1, \ldots, t_n)$  \\
            $[\varphi](\pi_1) = 1 ⇔ R^m([t_1](\pi_1), \ldots, [t_n](\pi_1))$
             \\
            $⇔$ (по лемме выше) $R^m([t_1](\pi_2), \ldots, [t_n](\pi_2))$
            $⇔ [\varphi](\pi_2) = 1$
            \item[(2)] 
            $FV(\varphi  ∧ \psi) = FV(\varphi) ∪ FV(\psi)$ \\
            $[\varphi  ∧ \psi](\pi_1)$ = И$([\varphi](\pi_1), [\psi](\pi_1)) 
            $ (по предположению индукции) = И$([\varphi](\pi_2), [\psi](\pi_2))
            = [\varphi  ∧ \psi](\pi_2)$
            \item[(3)]
            $FV(∀ z \psi) = FV(∀z) \backslash \{z\}$ \\  
            $\varphi=∀ z \psi ⇒ FV(\psi) = FV(\varphi) ∪ \{z\}$  \\

            \underline{Утверждение:} $∀ y ∈ FV(\psi) ⇒ \pi_{1 z}^m(y) = \pi_{2 z}^m(y)$
            \begin{proof} \ \\
                \begin{itemize} 
                    \item[1.] $y ∈ FV(\phi)$, тогда $y$ точно отличен от $z$. Значит,
                     $\pi_{1 z}^m(y) = \pi_1(y) = \pi_2(y) = \pi_{2 z}^m(y)$
                     \item[2.] $y$ совпадает с $z$, тогда
                     $\pi_{1 z}^m(y) = m = \pi_{2 z}^m(y)$  
                \end{itemize}   
            \end{proof}
            $⇒$ (по предположению индукции) 
            $[\psi](\pi_{1 z}^m(y)) = [\psi](\pi_{2 z}^m(y))$ \\[9.5pt]
            $[∀ z \psi](\pi_1) = 1 ⇔ ∀ m ∈ M [\psi](\pi_{1 z}^m) = 1
            ⇔ ∀ m ∈ M [\psi](\pi_{2 z}^m) = 1 ⇔ [∀ z \psi](\pi_1) = 1$
        \end{itemize}
    \end{proof}
    % Вопрос логика 4
    \subsection{Значение терма и формулы на наборе элементов структуры. Выразимые в структуре множества (отношения, функции, элементы). Примеры выразимых множеств. [MD] [F, с. 4]}
    \begin{proposition}[значение формулы на наборе элементов структуры]
        Зафиксируем $(x_1, x_2, ..., x_n) \in Var^n$, $x_1, ..., x_n$ попарно различны. Если $FV(\varphi) \subseteq \{x_1, ..., x_n\}$, то в качестве упрощённой записи будем писать $\varphi(x_1, ..., x_n)$. Пусть $\overrightarrow{a} = (a_1, ..., a_n) \in M^n$, тогда
        \[\forall \varphi(x_1, ..., x_n) \; \forall \overrightarrow{a} \; \forall \mathcal{\pi} \; \mathcal{M} \vDash \varphi(\overrightarrow{a}) \Leftrightarrow [\varphi]_{\mathcal{M}} (\pi_{x_1 \; x_2 \; ... \; x_n}^{a_1 \; a_2 \; ... \; a_n}) = 1\]
    \end{proposition}

    \begin{definition}
        Формула $\varphi(x_1, ..., x_n) \in Fm_{\sigma}$ выражает отношение $X \subseteq M^n$ в интерпретации $\mathcal{M}$ сигнатуры $\sigma \Leftrightarrow \forall \overrightarrow{a} \in M^n \; (\mathcal{M} \vDash \varphi(\overrightarrow{a}) \Leftrightarrow \overrightarrow{a} \in X)$. (Тогда пишут ещё $\varphi^{\mathcal{M}} = X$).
    \end{definition}

    Примеры выразимых множеств: \\
    \begin{enumerate}
        \item[1)] Пусть есть $\mathcal{M} = (\mathbb{N}; =^{(2)}; +^{(2)})$. В $\mathcal{M}$ выразимы ($\Leftrightarrow \exists \varphi$, которая выражает) $\{0\} \subseteq \mathbb{N}'; \text{ЧЁТНОЕ} \subseteq \mathbb{N}; \leq, < \; \subseteq \mathbb{N}^2$ \\
        \begin{itemize}
            \item $\varphi_0(x) \eqcirc \forall y \; (x + y = y)$ \\
            $\mathcal{M} \vDash \varphi_0(a) \Leftrightarrow a = 0 \Leftrightarrow a \in \{0\}$ \\
            \item $\varphi_{\text{чётн.}}(x) \eqcirc \forall y \; (x = y + y)$ \\
            $\mathcal{M} \vDash \varphi_{\text{чётн.}}(a) \Leftrightarrow a\text{ чётно} \Leftrightarrow a \in \text{ЧЁТНОЕ}$ \\
            \item $\varphi_{\leq}(x, y) \eqcirc \forall z \; (x + z = y)$ \\
            $\forall (a, b) \in \mathbb{N}^2 \; \mathcal{M} \vDash \varphi_{\leq}(a, b) \Leftrightarrow a \leq b$ \\
            \item $\varphi_{<}(x, y) \eqcirc \varphi_{\leq}(x, y) \wedge \neg (x = y)$
        \end{itemize}
        \item[2)] В поле $\mathcal{R}$ выразимо отношение $\mathbb{R}_{\geq 0}$ \\
        \begin{itemize}
            \item $\varphi_{\geq 0}(x) = \exists y \; (y \cdot y = x)$ \\
            $\forall a \in \mathbb{R} \; \mathcal{R} \vDash \varphi_{\geq 0}(a) \Leftrightarrow a \geq 0 \Leftrightarrow a \in \mathbb{R}_{\geq 0}$
        \end{itemize}
    \end{enumerate}
    % Вопрос логика 5
    \subsection{Значение формулы при изоморфизме структур. Элементарная эквивалентность структур. Изоморфные структуры элементарно эквивалентны. [MD, 10.5]}
 
    \underline{Теорема} (о значении формулы при изоморфизме). 
    
    Пусть $M, N$ -- какие-то интерпретации \textit{одной} сигнатуры $\sigma; \; \; \varphi(x_1, \dots, x_n) \in Fm_\sigma.$
    
    Тогда если $M \overset{\alpha}{\cong} N,$ то $\forall \overset{\to}{a} \in M^n $ верно  $M \vDash \varphi (\overset{\to}{a}) \iff N \vDash \varphi (\alpha \overset{\to}{a}).$
    
    \underline{Лемма.} Пусть $t(x_1, \dots x_n) \in Tm_\sigma.$ Если $M \overset{\alpha}{\cong} N$, то $\forall \overset{\to}{a} \in M^n \; \; \alpha (t^M (\overset{\to}{a})) = t^N (\alpha \overset{\to}{a}).$
    
    \begin{proof} Индукция по построению терма.
    
    \onehalfspacing $(I) \;  t = x_i \implies \begin{cases} t^M (a_1, \dots,  a_n) = a_i \\ t^N (b_1, \dots,  b_n) = b_i  \end{cases} \implies
    \begin{cases}
    \alpha (t^M (\overset{\to}{a})) = \alpha  \, a_i; \\
    t^N (\alpha \, \overset{\to}{a}) = t^N(\alpha \, a_1, \dots, \, \alpha \, a_n) = \alpha  \, a_i.
    \end{cases}$
    
    Как видим, получили одинаковое значение.
    
    $(II) \; t = c \implies
    \begin{cases}
    t^M (a_1, \dots a_n) = c^M;\\
    t^N (b_1, \dots b _n) = c^N.
    \end{cases} $
    
    $ \forall \pi \; [\, c \, ]_M (\pi) = c^M  \implies
    \alpha (t^M(\overset{\to}{a})) = \alpha \, c^M = c^N = t^N (\alpha \, \overset{\to}{a})\;$ из определения изоморфизма.
    
    $(III) \;\doublespacing  t = f \, t_1 \dots  t_m \implies
    t^M(\overset{\to}{a}) = f^M \left(t_1^M(\overset{\to}{a})   , \dots, t_m^M(\overset{\to}{a}) \right) \implies
    \alpha \,\left( t^M(\overset{\to}{a})\right) = \alpha \left(\, f^M \left(t_1^M(\overset{\to}{a})   , \dots, t_m^M(\overset{\to}{a}) \right) \right).
     $ 
    
    По определению изоморфизма,  $\dots =  f^N \left( \alpha \left(t_1^M(\overset{\to}{a})\right)   , \dots,  \alpha \left(t_m^M(\overset{\to}{a}) \right) \right).$ 
    
    Внутри уже более простые термы, для них воспользуемся предположением индукции:
    
    $\dots =   f^N \left(  t_1^N(\alpha \, \overset{\to}{a})   , \dots, t_m^N( \alpha \, \overset{\to}{a})  \right) = t^N(\alpha \, \overset{\to}{a}).$
    
    \end{proof}
        
    \begin{proof} (Теоремы о значении формулы)
    
    Индукция по построению $\varphi.$
    
    $(I) \; \varphi = R \, t_1 \dots t_m.$
    
    По лемме, $t_i^N \, (\alpha \, \overset{\to}{a}) = \alpha \, (t_i^M \, (\overset{\to}{a}))$
    
    $\begin{cases}
    M \vDash \varphi (\overset{\to}{a}) \iff \left( t_1^M(\overset{\to}{a} ), \dots ,  \, t_m^M(\overset{\to}{a} )  \right) \in R^M; \; \circledast \\
    N \vDash \varphi (\alpha \, \overset{\to}{a}) \iff \left( t_1^N(\alpha \, \overset{\to}{a} ), \dots ,  \, t_m^N(\alpha \,  \overset{\to}{a} )  \right) \in R^N \iff \left( \alpha \, (t_1^M \, (\overset{\to}{a})), \dots ,  \, \alpha \, (t_m^M \, (\overset{\to}{a}))  \right) \in R^N \iff \circledast \text{ по определению}. \\
    \end{cases}$ 
    
    $(II)$ Булевы связки. Приведём док-во для конъюнкции и отрицания.
    
    $\varphi \eqcirc (\Theta \land \psi ) (\overset{\to}{a}) \iff M \vDash \Theta(\overset{\to}{a})$  и $ M \vDash \psi(\overset{\to}{a}) \iff$ (по пред. инд.) $N \vDash \Theta(\alpha \, \overset{\to}{ a})$  и $ N \vDash \psi(\alpha \, \overset{\to}{ a}) \iff N \vDash (\Theta \land \psi ) (\alpha \, \overset{\to}{a})$.
    
    $M \vDash (\neg \psi) (\overset{\to}{a}) \iff M \nvDash \psi (\overset{\to}{a}) \iff N \nvDash \psi (\alpha \, \overset{\to}{a}) \iff  N \vDash (\neg \psi ) (\alpha \, \overset{\to}{a}).$
    
    $(III)$ Кванторы. 
    
    Пусть $\varphi \eqcirc \exists \, x \; \psi.$
    
    $M \vDash (\exists \, x \; \psi ) (\overset{\to}{a}) \iff $ сущ. $b \in M$, т.ч. $ M \vDash \psi (\overset{\to}{a}, b) \iff$ (по предположению индукции) $N \vDash \psi (\alpha \, \overset{\to}{a}, \, \alpha \, b).$
    
    $N \vDash (\exists \, x \; \psi ) (\alpha \, \overset{\to}{a}) \iff $ сущ. $c \in N$, т.ч. $ N \vDash \psi (\alpha \, \overset{\to}{a}, c).$
    
    В силу биективности $\alpha$, существование таких $b \in M$ и $c \in N$ равнозначны ($\forall \, c \in N \; \exists \,  b \in M  \; \; c = \alpha \, b$). Ч.т.д.
    
    Теперь пусть $\varphi \eqcirc \forall \, x \; \psi.$
    
    $M \vDash (\forall \, x \; \psi ) (\overset{\to}{a}) \iff $ для всех $b \in M$ верно $ M \vDash \psi (\overset{\to}{a}, b) \iff$ (по предположению индукции) $N \vDash \psi (\alpha \, \overset{\to}{a}, \, \alpha \, b).$
    
    $N \vDash (\forall \, x \; \psi ) (\alpha \, \overset{\to}{a}) \iff $ для всех $c \in N$ верно $ N \vDash \psi (\alpha \, \overset{\to}{a}, c).$
    
    В силу биективности $\alpha$ утверждения выше равнозначны ($\forall \, c \in N $ имеет вид $ \alpha \, b$ для всех $b \in M$). Ч.т.д.
    
    \end{proof}
    
    $St_\sigma$ -- \textit{множество предложений}.
    
    Пусть $M, N$ -- какие-то интерпретации \textit{одной} сигнатуры $\sigma. $
    
    $N$ и $M$ называются \underline{элементарно эквивалентными}, если $\forall \varphi \in St_\sigma$  верно $ M \vDash \varphi \iff  N \vDash \varphi.$  Обозначение -- $M \equiv N.$
    
    Иначе говоря, две интерпретации неразличимы ни одним предложением в $St_\sigma.$

    \underline{Утверждение.} $N \cong M \implies M \equiv N.$
    
    \begin{proof} Пусть $\varphi \in St_\sigma.$
    
    Известно, что $M \vDash \varphi (\overset{\to}{a}) \iff N \vDash \varphi (\alpha \overset{\to}{a})  \; \; \forall \overset{\to}{a}$ (теорема о значении формулы при изоморфизме).
    
    Пусть $\overset{\to}{a}$ -- пустой набор. Тогда, так как $\varphi$ не имеет свободных переменных,
    
    \[ M \vDash \varphi \iff   M \vDash \varphi (\overset{\to}{a}) \iff N \vDash \varphi (\alpha \overset{\to}{a}) \iff M \vDash \varphi\] 
    
    ведь $\alpha \overset{\to}{a}$ -- пустой набор, если $\overset{\to}{a}$ -- пустой набор.
    
    \end{proof}


    % Вопрос логика 6
    \subsection{Значение формулы при изоморфизме структур. Сохранение выразимых множеств автоморфизмами структуры. Примеры невыразимых множеств. [MD, 10.5]}

    Теорема о значении формулы при изоморфизме структур точно такая же, что и в предыдущем билете (см. формулировки билетов). \\
    \underline{Теорема} (о значении формулы при изоморфизме). 
    
    Пусть $M, N$ -- какие-то интерпретации \textit{одной} сигнатуры $\sigma; \; \; \varphi(x_1, \dots, x_n) \in Fm_\sigma.$
    
    Тогда если $M \overset{\alpha}{\cong} N,$ то $\forall \overset{\to}{a} \in M^n $ верно  $M \vDash \varphi (\overset{\to}{a}) \iff N \vDash \varphi (\alpha \overset{\to}{a}).$
    
    \underline{Лемма.} Пусть $t(x_1, \dots x_n) \in Tm_\sigma.$ Если $M \overset{\alpha}{\cong} N$, то $\forall \overset{\to}{a} \in M^n \; \; \alpha (t^M (\overset{\to}{a})) = t^N (\alpha \overset{\to}{a}).$
    
    \begin{proof} Индукция по построению терма.
    
    \onehalfspacing $(I) \;  t = x_i \implies \begin{cases} t^M (a_1, \dots,  a_n) = a_i \\ t^N (b_1, \dots,  b_n) = b_i  \end{cases} \implies
    \begin{cases}
    \alpha (t^M (\overset{\to}{a})) = \alpha  \, a_i; \\
    t^N (\alpha \, \overset{\to}{a}) = t^N(\alpha \, a_1, \dots, \, \alpha \, a_n) = a_i.
    \end{cases}$
    
    Как видим, получили одинаковое значение.
    
    $(II) \; t = c \implies
    \begin{cases}
    t^M (a_1, \dots a_n) = c^M;\\
    t^N (b_1, \dots b _n) = c^N.
    \end{cases} $
    
    $ \forall \pi \; [\, c \, ]_M (\pi) = c^M  \implies
    \alpha (t^M(\overset{\to}{a})) = \alpha \, c^M = c^N = t^N (\alpha \, \overset{\to}{a})\;$ из определения изоморфизма.
    
    $(III) \;\doublespacing  t = f \, t_1 \dots  t_m \implies
    t^M(\overset{\to}{a}) = f^M \left(t_1^M(\overset{\to}{a})   , \dots, t_m^M(\overset{\to}{a}) \right) \implies
    \alpha \,\left( t^M(\overset{\to}{a})\right) = \alpha \left(\, f^M \left(t_1^M(\overset{\to}{a})   , \dots, t_m^M(\overset{\to}{a}) \right) \right).
     $ 
    
    По определению изоморфизма,  $\dots =  f^N \left( \alpha \left(t_1^M(\overset{\to}{a})\right)   , \dots,  \alpha \left(t_m^M(\overset{\to}{a}) \right) \right).$ 
    
    Внутри уже более простые термы, для них воспользуемся предположением индукции:
    
    $\dots =   f^N \left(  t_1^N(\alpha \, \overset{\to}{a})   , \dots, t_m^N( \alpha \, \overset{\to}{a})  \right) = t^N(\alpha \, \overset{\to}{a}).$
    
    \end{proof}
        
    \begin{proof} (Теоремы о значении формулы)
    
    Индукция по построению $\varphi.$
    
    $(I) \; \varphi = R \, t_1 \dots t_m.$
    
    По лемме, $t_i^N \, (\alpha \, \overset{\to}{a}) = \alpha \, (t_i^M \, (\overset{\to}{a}))$
    
    $\begin{cases}
    M \vDash \varphi (\overset{\to}{a}) \iff \left( t_1^M(\overset{\to}{a} ), \dots ,  \, t_m^M(\overset{\to}{a} )  \right) \in R^M; \; \circledast \\
    N \vDash \varphi (\alpha \, \overset{\to}{a}) \iff \left( t_1^N(\alpha \, \overset{\to}{a} ), \dots ,  \, t_m^N(\alpha \,  \overset{\to}{a} )  \right) \in R^N \iff \left( \alpha \, (t_1^M \, (\overset{\to}{a})), \dots ,  \, \alpha \, (t_m^M \, (\overset{\to}{a}))  \right) \in R^N \iff \circledast \text{ по определению}. \\
    \end{cases}$ 
    
    $(II)$ Булевы связки. Приведём док-во для конъюнкции и отрицания.
    
    $\varphi \eqcirc (\Theta \land \psi ) (\overset{\to}{a}) \iff M \vDash \Theta(\overset{\to}{a})$  и $ M \vDash \psi(\overset{\to}{a}) \iff$ (по пред. инд.) $N \vDash \Theta(\alpha \, \overset{\to}{ a})$  и $ N \vDash \psi(\alpha \, \overset{\to}{ a}) \iff N \vDash (\Theta \land \psi ) (\alpha \, \overset{\to}{a})$.
    
    $M \vDash (\neg \psi) (\overset{\to}{a}) \iff M \nvDash \psi (\overset{\to}{a}) \iff N \nvDash \psi (\alpha \, \overset{\to}{a}) \iff  N \vDash (\neg \psi ) (\alpha \, \overset{\to}{a}).$
    
    $(III)$ Кванторы. 
    
    Пусть $\varphi \eqcirc \exists \, x \; \psi.$
    
    $M \vDash (\exists \, x \; \psi ) (\overset{\to}{a}) \iff $ сущ. $b \in M$, т.ч. $ M \vDash \psi (\overset{\to}{a}, b) \iff$ (по предположению индукции) $N \vDash \psi (\alpha \, \overset{\to}{a}, \, \alpha \, b).$
    
    $N \vDash (\exists \, x \; \psi ) (\alpha \, \overset{\to}{a}) \iff $ сущ. $c \in N$, т.ч. $ N \vDash \psi (\alpha \, \overset{\to}{a}, c).$
    
    В силу биективности $\alpha$, существование таких $b \in M$ и $c \in N$ равнозначны ($\forall \, c \in N \; \exists \,  b \in M  \; \; c = \alpha \, b$). Ч.т.д.
    
    Теперь пусть $\varphi \eqcirc \forall \, x \; \psi.$
    
    $M \vDash (\forall \, x \; \psi ) (\overset{\to}{a}) \iff $ для всех $b \in M$ верно $ M \vDash \psi (\overset{\to}{a}, b) \iff$ (по предположению индукции) $N \vDash \psi (\alpha \, \overset{\to}{a}, \, \alpha \, b).$
    
    $N \vDash (\forall \, x \; \psi ) (\alpha \, \overset{\to}{a}) \iff $ для всех $c \in N$ верно $ N \vDash \psi (\alpha \, \overset{\to}{a}, c).$
    
    В силу биективности $\alpha$ утверждения выше равнозначны ($\forall \, c \in N $ имеет вид $ \alpha \, b$ для всех $b \in M$). Ч.т.д.
    
    \end{proof}

    \begin{theorem}[Выразимые отношения сохраняются всеми автоморфизмами структуры]
        Если $X$ выразимо в $\mathcal{M}$, то $\forall \overrightarrow{a} \in M^n \; \; \overrightarrow{a} \in X \Leftrightarrow \alpha \overrightarrow{a} \in X$.
    \end{theorem}

    \begin{proof}
        $X$ выразимо $\implies$ по определению $\exists \varphi(x_1, ..., x_n) \; \forall \overrightarrow{a} \in M^n \; \; \overrightarrow{a} \in X \Leftrightarrow \mathcal{M} \vDash \varphi(\overrightarrow{a})$ \\
        $\mathcal{M} \stackrel{\alpha}{\cong} \mathcal{M} \implies \overrightarrow{a} \in X \Leftrightarrow \mathcal{M} \vDash \varphi(\overrightarrow{a}) \Leftrightarrow \text{[по теореме о значении формулы при изоморфизме]} \Leftrightarrow \mathcal{M} \vDash \varphi(\alpha \overrightarrow{a}) \Leftrightarrow \alpha \overrightarrow{a} \in X$. $\blacksquare$
    \end{proof}

    \begin{proposition}
        Пусть $\mathcal{M} = (\mathbb{Z}; <); \mathcal{M} \stackrel{\alpha}{\cong} \mathcal{M}; \alpha(x) = x + 1$. Тогда множество $\mathbb{Z}_+ = \{ n \in \mathbb{Z} \mid n > 0 \}$ не выразимо в $\mathcal{M}$.
    \end{proposition}

    \begin{proof}
        $\alpha \in Aut(\mathcal{M})$ \\
        $0 \notin \mathbb{Z}_+$, но $\alpha(0) = 1 \in \mathbb{Z}_+$, таким образом $\exists a \in \mathbb{Z}: \; a \in \mathbb{Z}_+ \nLeftrightarrow \alpha a \in \mathbb{Z}_+$. \\
        Значит $\mathbb{Z}_+$ не выразимо в $\mathcal{M}$.
    \end{proof}

    % Вопрос логика 7
    \subsection{Общезначимые и выполнимые формулы. [F, 12] Эквивалентность формул первого порядка. [F, с. 4] Лемма о фиктивном кванторе. [F, 10] Квантор всеобщности и общезначимость. [F, 12]}
    
    \subsubsection{Общезначимые и выполнимые формулы.}

    Пусть фиксирована сигнатура $\sigma$. 
    \begin{definition}
        Формула $\varphi$ {\it общезначима}, если для любой интерпретации $\mathcal{M}$, для 
        любой оценки переменных $\pi$ в этой самой интерпретации: $\text{Var} \to M$ 
        \[
            [\varphi]_{\mathcal{M}}(\pi) = 1.
        \]
        (Как ее ни интерпретируй, что с ней ни делай, будет принимать значение 1, 
        которое всегда истинно.)
    \end{definition}

    \begin{example}
        \[
            \psi = Px \implies (\neg Px \implies Qyz)
        \]
        Если $Px$ ложь, то $\psi$ истинна, иначе получаем $\psi \colon 1 \implies 
        (0 \implies *)$ --- тоже истина (запись варварская, ну и что?) $\implies 
        \psi $ общезначима. 
    \end{example}
    % \begin{example}
    %     \[
    %         \phi = \forall x Px \implies \exists x Px.
    %     \]
    %     Ничего не зависит от $P$, то есть $\phi$ всегда верно, если $M \neq 
    %     \varnothing$ (по определению $M$, это правда) $\implies \phi $ общезначима.
    % \end{example}
    \begin{example}
        Рассмотрим формулу
        \[
            \varphi \eqcirc Px \lor \neg Qy.
        \]
        Положим $M = \NN$, $P^{\mathcal{M}} = Q^{\mathcal{M}} =$ 
        ''равно 0'', $\pi(x) = 2020$, $\pi(y) = 0$.
        Тогда значение $\varphi$ ложно $ \implies \varphi $ не общезначима.
    \end{example}

    \begin{definition}
        Формула $\varphi$ {\it выполнима}, если существует интерпретация $\mathcal{M}$ 
        и оценка $\pi$ такая, что
        \[
            [\varphi]_{\mathcal{M}}(\pi) = 1.
        \]
        Общезначимая формула истинна всегда, выполнимая истинна в каком-то случае.
    \end{definition}
        
    \begin{example}
        Рассмотрим формулу
        \[
            \varphi = (x - 3 > 1)
        \]
        При $M = \NN$ и $\pi$ такой, что $\pi(x) = 5$ 
        \[
            [\varphi]_{\mathcal{M}}(\pi) = 1
        \] 
        $\implies$ $\phi$ выполнима.
    \end{example}
        
    \begin{lemma}
        Формула $\varphi$ общезначима $\iff$ $\neg \varphi$ не выполнима.
    \end{lemma}

    \begin{lemma}
        Формула $\varphi$ выполнима $\iff$ $\neg \varphi$ не общезначима.
    \end{lemma}

    \subsubsection{Эквивалентность формул первого порядка.}

    Формулы первого порядка --- формулы, в которых кванторы берутся только по элементам 
    носителя.
    \begin{example}
        первый порядок: $\forall x \in M$, 
        не первый порядок: $\forall y \subseteq M$
    \end{example}

    \begin{definition}
        Формулы $\phi$ и $\psi$ (логически) эквивалентны, если для любой интерпретации
        $\mathcal{M}$, для любой оценки $\pi$
        \[
            [\varphi]_{\mathcal{M}}(\pi) = [\psi]_{\mathcal{M}}(\pi).
        \]
    \end{definition}

    \begin{lemma}
        Определенная выше эквивалентность является отношением эквивалентности:
        \begin{enumerate}[topsep=0pt]
            \item $\varphi \equiv \varphi$;
            \item $\varphi \equiv \psi \implies \psi \equiv \varphi$;
            \item $\varphi \equiv \psi \land \psi \equiv \theta \implies \psi \equiv \theta$.
        \end{enumerate}
    \end{lemma}

    \begin{lemma}[О конгруэнции отношения эквивалентности]
        Если $\varphi \equiv \varphi^{\prime}$, то
        \begin{itemize}[topsep=0pt]
            \item $\neg \varphi \equiv \neg \varphi^{\prime}$;
            \item $\varphi \land \psi \equiv \varphi^{\prime} \land \psi$.
            \item $\varphi \lor \psi \equiv \varphi^{\prime} \lor \psi$.
            \item $\varphi \implies \psi \equiv \varphi^{\prime} \implies \psi$.
            \item $\psi \implies \varphi \equiv \psi \implies \varphi^{\prime}$.
            \item $\forall x \varphi \equiv \forall x \varphi^{\prime}$.
            \item $\exists x \varphi \equiv \exists x \varphi^{\prime}$.
        \end{itemize}
        Так как значение сложной формулы определяется через значения ее подформул и 
        для любой интерпретации $\mathcal{M}$, для любой оценки $\pi$ значение 
        $\varphi$ можно заменить на значение $\varphi^{\prime}$.
    \end{lemma}

    \begin{proof}
        Докажем одно из утверждений. 

        $[\forall x \varphi]_{\mathcal{M}}(\pi) = 1 
        \iff \forall m \in M~[\varphi]\left( \pi_{x}^{m} \right) = 1$, 
        но $[\varphi]\left( \pi_{x}^{m} \right) = 
        [\varphi^{\prime}]\left( \pi_{x}^{m} \right)$, тогда 
        $[\varphi^{\prime}]\left( \pi_{x}^{m} \right) = 1$.
    \end{proof}

    \begin{lemma}
        $\varphi \equiv \psi \iff $ общезначима формула
        \[
            (\varphi \implies \psi) \land (\psi \implies \varphi).
        \]
        Импликация истинна $\iff$ значение посылки не больше значения заключения, 
        а в лемме сказано, что они одинаковы.
    \end{lemma}
    \begin{lemma}
        Формула $\varphi$ общезначима тогда и только тогда, когда
        \[
            \varphi \equiv \top \ (\text{''заведомая истина''}).
        \]
    \end{lemma}

    \begin{corollary}
        Все общезначимые формулы эквивалентны друг другу.
    \end{corollary}

    \subsubsection{Лемма о фиктивном кванторе.}

    \begin{lemma}[О фиктивном кванторе.]
        Если $x \notin \text{FV}(\varphi)$, то $\forall x \varphi \equiv \varphi$.
        Аналогично, $\exists x \varphi \equiv \varphi$.
    \end{lemma}

    \begin{proof}
        Рассмотрим произвольную интерпретацию $\mathcal{M}$ и оценку $\pi$. По определению: 
        \[
            [\forall x \varphi]_{\mathcal{M}}(\pi) = 1 \iff \forall m \in M~ [\varphi](\pi_{x}^{m}) = 1.
        \]
        где 
        \[
            \pi_{x}^{m}(z) = 
            \begin{cases}
                m, & y \eqcirc x,  \\
                \pi(y), & y \not \eqcirc x.
            \end{cases}
        \]
        Вспомним лемму о том, что $\forall z \in \text{FV}(\psi) \colon \pi_{1}(z) = 
        \pi_{2}(z)$, то $[\psi]_{\mathcal{M}}(\pi_{1}) = [\psi]_{\mathcal{M}}(\pi_{2})$.
        
        Оценки $\pi_{x}^{m}$ и $\pi$ подходят под эту лемму, так как отличаются только в $x$, 
        а $x \notin \text{FV}(\varphi)$. 

        Тогда
        \[
            [\forall x \varphi]_{\mathcal{M}}(\pi) = 1 \iff \forall m \in M~ [\varphi](\pi_{x}^{m}) = 1 \iff
            \forall m \in M~ [\varphi](\pi) = 1 \iff [\varphi](\pi) = 1
        \]
        Последний переход верен, так как значение $[\varphi](\pi)$ не зависит от $m$.
    \end{proof}

    \begin{corollary}
        $\forall x \exists x \varphi \equiv \exists x \varphi$. 
        (Так как $x \notin \text{FV}(\exists x \varphi)$.)
    \end{corollary}


    \subsubsection{Квантор всеобщности и общезначимость.}

    \begin{lemma}
        Формула $\varphi$ общезначима $\iff$ $\forall x \varphi$ общезначима.
    \end{lemma}
    
    \begin{proof}~
        \begin{description}
            \item[$\implies$] Дано: $\forall \mathcal{M},~\forall \pi \colon [\varphi]_{\mathcal{M}}(\pi) = 1$.
            Хотим доказать: $\forall \mathcal{M},~\forall \rho \colon [\forall x \varphi]_{\mathcal{M}}(\rho) = 1$.
            Зафиксируем какие-то $\mathcal{M}$ и $\rho$, тогда
            \[
                [\forall x \varphi](\rho) = 1 \iff \forall m \in M~ [\varphi]\left(\rho_{x}^{m}\right) = 1.
            \]
            Последнее --- то, что мы хотим получить. Однако 
            \[
                ~\forall \pi \colon [\varphi]_{\mathcal{M}}(\pi) = 1 \implies
                ~\forall \pi \colon \forall m \in M [\varphi]_{\mathcal{M}}(\pi) = 1 \implies
                \forall m \in M [\varphi]_{\mathcal{M}}(\rho_{x}^{m}) = 1
            \]
            (Добавили квантор, который ничего не меняет и подставили $\pi = \rho_{x}^{m}$, получили
            то, что хотели для выбранной $\rho$.)
            
            \item[$\impliedby$] Дано: $\forall \mathcal{M},~\forall \pi \colon [\forall x \varphi]_{\mathcal{M}}(\pi) = 1$.
            Хотим доказать: $\forall \mathcal{M},~\forall \rho \colon [\varphi]_{\mathcal{M}}(\rho) = 1$.

            Зафиксируем какие-то $\mathcal{M}$ и $\rho$, тогда
            \[
                \forall \pi \colon [\forall\varphi]_{\mathcal{M}}(\pi) = 1 \iff
                \forall \pi \colon \forall m \in M \colon [\varphi]_{\mathcal{M}}\left(\pi_{x}^{m}\right) = 1
            \]
            Возьмем $\pi = \rho$, $m = \rho(x)$, тогда $\pi_{x}^{m} = \rho_{x}^{\rho(x)} = \rho$. 
            Получаем $[\varphi]_{\mathcal{M}}(\rho) = 1$.
        \end{description}
    \end{proof}

    % Вопрос логика 8
    \subsection{Основные эквивалентности логики первого порядка [F, 24]. Замена подформулы на эквивалентную. [F, 26, 30]}

    \subsubsection{Основные эквивалентности логики первого порядка}
    Эквивалентности алгебры логики:
    \begin{align}
        \varphi \implies \psi &\equiv \neg \varphi \lor \psi, \\
        \neg \varphi \implies \neg \psi &\equiv \psi \implies \varphi, \\
        \neg (\varphi \implies \psi) &\equiv \varphi \land \neg \psi, \\
        \neg \neg \varphi &\equiv \varphi, \\
        \neg (\varphi \land \psi) &\equiv \neg \varphi \lor \neg \psi, \\
        \neg (\varphi \lor \psi) &\equiv \neg \varphi \land \neg \psi, \\
        \varphi \land (\psi \lor \theta) &\equiv  (\varphi \land \psi) \lor (\varphi \land \theta), \\
        \varphi \lor (\psi \land \theta) &\equiv (\varphi \lor \psi) \land (\varphi \land \theta), \\
        \varphi \land (\varphi \lor \psi) &\equiv \varphi, \\
        \varphi \lor (\varphi \land \psi) &\equiv \varphi, \\
        \varphi \land \psi &\equiv \psi \land \varphi, \\
        \varphi \land \varphi &\equiv \varphi, \\
        (\varphi \land \psi) \land \theta &\equiv \varphi \land (\psi \land \theta).
    \end{align}
    Последние три эквивалентности также верны, если $\land$ заменить на $\lor$.
    Все эквивалентности доказываются по таблице истинности.

    \begin{theorem}[Основные эквивалентности с кванторами]~
        \begin{enumerate}
            \item \begin{align}
                \forall x (\varphi \land \psi) &\equiv \forall x \varphi \land \forall x \psi, \\
                \exists x (\varphi \lor \psi) &\equiv \exists x \varphi \lor \exists x \psi.
            \end{align}
            \item Пусть $x \notin \text{FV}(\psi)$, тогда \begin{align}
                \forall x (\varphi \land \psi) &\equiv \forall x \varphi \land \psi, \\
                \exists x (\varphi \land \psi) &\equiv \exists x \varphi \land \psi, \\
                \forall x (\varphi \lor \psi) &\equiv \forall x \varphi \lor \psi, \\
                \exists x (\varphi \lor \psi) &\equiv \exists x \varphi \lor \psi.
            \end{align}
            \item \begin{align}
                \neg \forall x \varphi &\equiv \exists x \neg \varphi, \\
                \neg \exists x \varphi &\equiv \forall x \neg \varphi.
            \end{align}
        \end{enumerate}
    \end{theorem}

    Доказательство проводится за счет определения: постепенно превращаем 
    это утверждение в утверждение про неформальные кванторы.
    Проверим одно из них.

    \begin{proof} {(2.2)}
        Зафиксируем $\mathcal{M}$ и $\pi$.
    

        \begin{multline}
            [\exists x (\varphi \land \psi)](\pi) = 1 \iff 
            \exists m \in M~ [\varphi \land \psi]\left(\pi_{x}^{m}\right) = 1 \iff \\
            \iff \exists m \in M~ \text{И}\left([\varphi]\left(\pi_{x}^{m}\right) = 1, [\psi]\left(\pi_{x}^{m}\right) = 1\right) \iff 
            \exists m \in M~ \text{И}\left([\varphi]\left(\pi_{x}^{m}\right) = 1, [\psi]\left(\pi\right) = 1\right) \iff \\
            \left( \exists m \in M~  [\varphi]\left(\pi_{x}^{m}\right) = 1\right) \text{ И } [\psi]\left(\pi\right) = 1 \iff
            [\exists x \varphi](\pi) = 1 \text{ И } [\psi](\pi) = 1 \iff 
            [\exists x \varphi \land \psi](\pi) = 1
        \end{multline}

        Сначала делаем переход по определению. Потом заменяем $\land$ на функцию И(). 
        Затем заменяем для $\psi$ оценку с $\pi_{x}^{m}$ на $\pi$, так как их значения не 
        отличаются на свободных переменных (была теорема, что в этом случае замена равносильна). 
        Далее выносим $[\psi]\left(\pi\right)$, не зависящую от $m$. Оставшиеся переходы 
        по определениям. 
    \end{proof}

    \begin{corollary}[Выразимость одного квантора через другой] \
        \begin{enumerate}[topsep=0pt]
            \item $\forall x \varphi \equiv \forall x \neg \neg \varphi \equiv \neg \exists x \neg \varphi.$
            \item $\exists x \varphi \equiv \neg \forall x \neg \varphi.$
        \end{enumerate}
    \end{corollary}

    \begin{corollary}
        Пусть $x \notin \text{FV}(\psi)$, тогда
        \begin{align}
            \forall x (\varphi \implies \psi) &\equiv \exists x\varphi \implies \psi, \\
            \exists x (\varphi \implies \psi) &\equiv \forall x\varphi \implies \psi, \\
            \forall x (\psi \implies \varphi) &\equiv \psi \implies \forall \varphi, \\
            \exists x (\psi \implies \varphi) &\equiv \psi \implies \exists \varphi.
        \end{align}
    \end{corollary}
    
    При вынесении квантора из посылки, он меняется на противоположный.
    При вынесении квантора из заключения, он остается тем же.
    
    \begin{proof}
        $\forall x (\varphi \implies \psi) \equiv \forall x (\neg \varphi \lor \psi)$.
        Так как $x \notin \text{FV}(\psi)$, то
        \[
            \forall x (\neg \varphi \lor \psi) \equiv \forall x \neg \varphi \lor 
            \psi \equiv \neg \exists x \varphi \lor \psi \equiv \exists x \varphi 
            \implies \psi.
        \]
    \end{proof}

    \subsubsection{Замена подформулы на эквивалентную.}

    Если в формуле заменить какое-либо вхождение некоторой подформулы на 
    эквивалентную этой подформуле формулу, мы получим формулу, эквивалентную исходной.
    (На лекции было только это.)
    
    То же самое другими словами из конспекта first\_order:

    \begin{lemma}
        Пусть $\psi \equiv \psi^\prime$ и формула $\phi^\prime$ получена из $\phi$ 
        заменой некоторых вхождений $\psi$ на $\psi^\prime$. Тогда $\phi \equiv \phi^\prime$.
    \end{lemma}

    % Вопрос логика 9
    \subsection{Булевы комбинации формул. Булева функция, соответствующая булевой комбинации. Теорема о приведении булевой комбинации к дизъюнктивной нормальной форме и к конъюнктивной нормальной форме.}

    \subsubsection{Булевы комбинации формул.}

    Пусть фиксирован набор попарно различных формул (атомарных или вида 
    $\forall x \varphi$, $\exists x \varphi$) $(F_{1}, \ldots, F_{n})$ в 
    сигнатуре $\sigma$.
    \begin{definition}
        Определим множество $\mathcal{B}(F_{1}, \ldots, F_{n})$ {\it булевых комбинаций}
         формул из $(F_{1}, \ldots, F_{n})$ следующим образом:
        \begin{enumerate}
            \item $\forall i~F_{i} \in \mathcal{B}(F_{1}, \ldots, F_{n})$;
            \item $\varphi, \psi \in \mathcal{B}(F_{1}, \ldots, F_{n}) \implies \neg 
            \varphi, (\varphi \land \psi), (\varphi \lor \psi), (\varphi \implies \psi), 
            (\varphi \iff \psi) \in \mathcal{B}(F_{1}, \ldots, F_{n})$.
        \end{enumerate}
    \end{definition}
    
    Хотим понять, как определяется истинность булевой комбинации.
    Каждой $\varphi \in \mathcal{B}(F_{1}, \ldots, F_{n})$ поставим в соответствие булеву
    функцию $f_{\varphi} \colon \{0, 1\}^{n} \to \{0, 1\}$ таким образом, что (дальше 
    рекурсией по построению)
    \begin{enumerate}
        \item $\varphi \eqcirc F_{i} \implies f_{\varphi}(x_{1}, \ldots, x_{n}) = x_{i}$;
        \item \begin{enumerate}
            \item $\varphi \eqcirc \neg \psi \implies f_{\varphi}(\vec{x}) = 
            \text{НЕ}(f_{\psi}(\vec{x}))$;
            \item $\varphi \eqcirc \psi \lor \theta \implies f_{\varphi}(\vec{x}) = 
            \text{ИЛИ}(f_{\psi}(\vec{x}), f_{\theta}(\vec{x}))$;
            \item Аналогично для других связок.
        \end{enumerate}
    \end{enumerate}
    
    \begin{lemma}
        Для любой формулы $\varphi \in \mathcal{B}(F_{1}, \ldots, F_{n})$, $\forall M$,
         $\forall \pi$
        \[
            [\varphi]_{\mathcal{M}}(\pi) = f_{\varphi}\left([F_{1}]_{\mathcal{M}}(\pi),
             \ldots, [F_{n}]_{\mathcal{M}}(\pi)\right).
        \]
    \end{lemma}
    
    \begin{proof}
        Индукцией по построению $\varphi$.
    \end{proof}
    
    \begin{definition}
        Формула $\varphi \in \mathcal{B}(F_{1}, \ldots, F_{n})$ называется {\it тавтологией}, если $\forall \vec{x}$ $f_{\varphi}(\vec{x}) = 1$.
    \end{definition}
    
    \begin{proposal}
        Если $\varphi$ тавтология, то $\varphi$ общезначима. 
        (Следует из леммы выше.)
    \end{proposal}
    
    Не всякая общезначимая формула является тавтологией.
    Например, формула $\varphi = \forall x Px \implies \exists x Px$ не является 
    тавтологией, потому что, если представить ее в виде булевой комбинации, она будет 
    иметь вид $F_{1} \implies F_{2}$, и ей будет соответствовать функция 
    $\text{ИМП}(x_{1}, x_{2})$, которая не всегда истинна.
    
    \subsubsection{Булева функция, соответствующая булевой комбинации.}

    \begin{definition}[ДНФ над набором формул]
        Пусть фиксирован набор формул $(F_{1}, \ldots, F_{n})$ (как прежде).
        Определим дизъюнктивную нормальную форму следующим образом:
        \begin{enumerate}
            \item $F_{i}$ или $\neg F_{i}$ --- {\it литералы};
            \item Если $l_{1}, \ldots, l_{k}$ --- литералы, то $l_{1} \land \ldots \land  l_{k}$ --- {\it элементарная конъюнкция};
            \item Если $c_{1}, \ldots, c_{m}$ --- элементарные конъюнкции, то $c_{1} \lor \ldots \lor c_{m}$ --- ДНФ над набором $(F_{1}, \ldots, F_{n})$.
        \end{enumerate}
    \end{definition}
    
    \begin{definition}[КНФ над набором формул]
        Пусть фиксирован набор формул $(F_{1}, \ldots, F_{n})$ (как прежде).
        Определим конъюнктивную нормальную форму следующим образом:
        \begin{enumerate}
            \item $F_{i}$ или $\neg F_{i}$ --- {\it литералы};
            \item Если $l_{1}, \ldots, l_{k}$ --- литералы, то $l_{1} \lor \ldots \lor  l_{k}$ --- {\it элементарная дизъюнкция};
            \item Если $d_{1}, \ldots, d_{m}$ --- элементарные дизъюнкции, то $d_{1} \land \ldots \land d_{m}$ --- КНФ над набором $(F_{1}, \ldots, F_{n})$.
        \end{enumerate}
    \end{definition}
    
    ДНФ и КНФ, вообще говоря, являются разными объектами.
    Например,
    \[
        (F_{1} \land \neg F_{2} \land F_{1}) \lor (\neg F_{3}) \lor (F_{1} \land F_{4})
    \]
    является ДНФ, но не является КНФ, потому что в дереве разбора формулы ниже дизъюнкции стоит конъюнкции.
    
    Однако, существуют формулы, которые являются одновременно КНФ и ДНФ, например
    \[
        F_{1} \land \neg F_{2}; \quad F_{3} \land \neg F_{4} \land F_{5}.
    \]
    На самом деле, одновременно КНФ и ДНФ являются литералы и элементарные конъюнкции (дизъюнкции).
    
    \begin{corollary}
        $\text{CNF}\left(\vec{F}\right) \cup \text{DNF}\left(\vec{F}\right) 
        \subseteq \mathcal{B}\left(\vec{F}\right)$.
    \end{corollary}

    \subsubsection{Теорема о приведении булевой комбинации к дизъюнктивной нормальной форме и к конъюнктивной нормальной форме.}

    \begin{theorem}
        Любую булеву комбинацию $\varphi \in \mathcal{B}(F_{1}, \ldots, F_{n})$ существуют 
        $\varphi_{1} \in \text{DNF}(F_{1}, \ldots, F_{n})$ и $\varphi_{2} \in 
        \text{CNF}(F_{1}, \ldots, F_{n})$ такие, что
        \[
            \varphi \equiv \varphi_{1} \land \varphi \equiv \varphi_{2}.
        \]
    \end{theorem}
  
    \begin{proof}
        Все доказательство будет строиться вокруг рассмотрения функции $f_{\varphi} \colon 
        \{0, 1\}^{n} \to \{0, 1\}$, которая истиностные значения формул $F_{1}, 
        \ldots, F_{n}$ превращает в истиностное значение формулы $\varphi$.
        В любой интерпретации и при любой оценке переменных
        \[
            [\varphi](\pi) = f_{\varphi}([F_{1}](\pi), \ldots, [F_{n}](\pi)) = 
            f_{\varphi}([\vec{F}](\pi)).
        \]
        Теперь давайте исследуем функцию $f_{\varphi}$.
        Рассмотрим $U = \{\sigma \in \{0, 1\}^{n} \mid f_{\varphi}(\vec{\sigma}) = 1\}$.
        Надо рассмотреть несколько случаев:
        \begin{enumerate}
            \item $U = \varnothing$.
            Тогда для любого $\pi$ $[\varphi](\pi) = f_{\varphi}([\vec{F}](\pi)) = 0$.
            Положим $\varphi_{1} = F_{1} \land \neg F_{1}$, тогда $\varphi_{1} \equiv \varphi$.
            \item $U \neq \varnothing$.
            Пусть $A \in \text{Fm}$, а $\sigma \in \{0, 1\}$, тогда положим
            \[
                A^{\sigma} = 
                \begin{cases}
                    A, & \sigma = 1, \\
                    \neg A, & \sigma = 0.
                \end{cases}
            \]
            \begin{proposal}
                $[A^{\sigma}](\pi) = 1 \iff \sigma = [A](\pi)$.
            \end{proposal}
            \begin{proof}
                Действительно, если $\sigma = 1$, то $[A^{1}](\pi) = [A](\pi)$, то есть
                 $[A^{1}](\pi) = 1 \iff [A](\pi) = 1$.
                Если же $\sigma = 0$, то $[A^{0}](\pi) = 1 \iff [\neg A](\pi) = 1 \iff 
                [A](\pi) = 0 = \sigma$.
            \end{proof}
            \begin{corollary} 

                $\Phi_{\vec{\sigma}} = [F_{1}^{\sigma_{1}} \land \ldots \land 
                F_{n}^{\sigma_{n}}](\pi) = 1 \iff \forall i [F_{i}^{\sigma_{i}}](\pi) = 1 \iff 
                \forall i~\sigma_{i} = [F_{i}](\pi) \iff \vec{\sigma} = [\vec{F}]$.
            \end{corollary}
            $[\varphi](\pi) = 1$ тогда и только тогда, когда $f_{\varphi}([\vec{F}](\pi)) = 1 \iff [\vec{F}](\pi) 
            \in U \iff \exists \vec{\sigma} \in U~ [\vec{F}](\pi) = \vec{\sigma}$.
            Получилось тоже самое, что и в следствии выше, 
            поэтому это все равносильно тому, что $\exists \vec{\sigma} \in 
            U~[\Phi_{\vec{\sigma}}](\pi) = 1 \iff [\bigvee\limits_{\vec{\sigma} 
            \in U}\Phi_{\vec{\sigma}}](\pi) = 1$.
            Но если $\varphi$ и $\bigvee\limits_{\vec{\sigma} \in U}\Phi_{\vec{\sigma}}$ 
            принимают значение 1 одновременно, то и значение 0 они принимают одновременно 
            (поскольку возможных значений всего два), тогда $\varphi \equiv 
            \bigvee\limits_{\vec{\sigma} \in U}\Phi_{\vec{\sigma}} \equiv 
            \bigvee\limits_{\vec{\sigma} \in U} F_{1}^{\sigma_{1}} \land \ldots
             \land F_{n}^{\sigma_{n}} \in \text{DNF}(F_{1}, \ldots, F_{n})$.
        \end{enumerate}
        Построим теперь КНФ.
        На этот раз проанализируем множество $Z = \{\vec{\sigma} \mid 
        f_{\varphi}(\vec{\sigma}) = 0\}$.
        Рассмотрим несколько случаев:
        \begin{enumerate}
            \item $Z = \varnothing$.
            Тогда для любого $\pi$ $[\varphi](\pi) = 1$.
            Положим $\varphi_{2} = F_{1} \lor \neg F_{1} \equiv \varphi$.
            \item Делаем все тоже самое, что и для ДНФ, только наоборот.
            Рассмотрим формулу $\psi_{\vec{\sigma}} = F_{1}^{\overline{\sigma_{1}}} 
            \lor \ldots \lor F_{n}^{\overline{\sigma_{n}}}$, где $\overline{\sigma_{i}}$ 
            значит отрицание $\sigma_{i}$, тогда
            \[
                \left[F_{1}^{\overline{\sigma_{1}}} \lor \ldots \lor 
                F_{n}^{\overline{\sigma_{n}}}\right](\pi) = 0 \iff \forall i~ 
                [F_{i}^{\overline{\sigma_{i}}}](\pi) = 0 \iff \forall i~ \overline{\sigma_{i}} 
                \neq [F_{i}](\pi) \iff \forall i~ \sigma_{i} = [F_{i}](\pi) \iff \vec{\sigma} = 
                [\vec{F}](\pi).
            \]
            Что же мы делаем дальше?
            Дальше мы смотрим, когда $[\varphi](\pi) = 0 \iff f_{\varphi}([\vec{F}](\pi)) = 0 
            \iff [\vec{F}](\pi) \in Z \iff \exists\vec{\sigma} \in Z~ [\vec{F}](\pi) = \sigma$.
            Это равносильно тому, что $\exists \vec{\sigma} \in Z~[\psi_{\vec{\sigma}}](\pi) = 0 
            \iff [\bigwedge\limits_{\vec{\sigma} \in Z}\psi_{\vec{\sigma}}](\pi) = 0$, отсюда 
            $\varphi \equiv \bigwedge\limits_{\vec{\sigma} \in Z}\psi_{\vec{\sigma}} \in \text{CNF}(F_{1}, 
            \ldots, F_{n})$.
        \end{enumerate}
    \end{proof}
    
    Если мы хотим использовать это на практике, то надо, прежде всего, найти функцию 
    $f_{\varphi}$ (то есть, построить таблицу истинности).
    Такая таблица будет являться таблицей зависимости значений формулы $\varphi$ от значений 
    образующих ее формул.
    Дальше, если строим ДНФ, то мы берем наборы, где наша функция принимает значение 1.
    Каждый такой набор мы кодируем элементарной конъюнкцией $F_{1}^{\sigma_{1}} \land \ldots 
    \land F_{n}^{\sigma_{n}}$ и берем их дизъюнкцию.
    
    Также, можно не пускать каждый раз в ход этот алгоритм, а просто пользоваться 
    элементарными эквивалентностями, и, раскрывая скобки, получить ДНФ (КНФ).

    % Вопрос логика 10
    \subsection{Лемма о корректной подстановке. [F, 73]}
    \begin{lemma} В любой интерпретации при любой оценке $\pi$ дл всех $\varphi \in \text{Fm}_{\sigma}, \, t, s \in \text{Tm}_{\sigma}$ и $x \in \text{Var}$, если $t-x-\varphi$, то
    \[ [s(t/x)](\pi) = [s](\pi + (x \mapsto [t](\pi))) \text{ и } [\varphi(t/x)](\pi) = [\varphi](\pi + (x \mapsto [t](\pi)). \]
    \end{lemma}
    
    \begin{proof} Подобно лемме F18 (являющейся частным случаем данной) доказывается индукцией по построению:\\[-10 pt]
    
    Пусть $s = z \ne x$. Имеем $[s(t/x)](\pi) = \pi(z) = [s](\pi + (x \mapsto [t](\pi)))$. Если же $s = x$, то $[s(t/x)](\pi) = [t](\pi) = [s](\pi + (x \mapsto [t](\pi)))$. Случай $s = \F_i$ тривиален (значение константы не меняется).\\[-10 pt]
    
    Если $s = \F_j(t_1, t_2, \ldots, t_{a_j})$, то по предположению индукции:
    \begin{multline*}
    [s(t/x)](\pi) = \F_j([t_1(t/x)](\pi), \ldots, [t_{a_j}(t/x)](\pi)) = \\
    = \F([t_1](\pi + (x \mapsto [t](\pi))), \ldots, [t_{a_j}](\pi + (x \mapsto [t](\pi)))) = [s](\pi + (x \mapsto [t](\pi))).
    \end{multline*}
    
    Случай $\varphi = \mathbbold{P}_i$ тривиален (константа). Если $\varphi = \mathbbold{P}_j(t_1, t_2, \ldots, t_{a_j})$, то по предположению индукции:
    \begin{multline*}
    [\varphi(t/x)](\pi) = \mathbbold{P}_j([t_1(t/x)](\pi), \ldots, [t_{a_j}(t/x)](\pi)) = \\
    = \mathbbold{P}([t_1](\pi + (x \mapsto [t](\pi))), \ldots, [t_{a_j}](\pi + (x \mapsto [t](\pi)))) = [\varphi](\pi + (x \mapsto [t](\pi))).
    \end{multline*}
    
    <<Принципиальный>> случай, когда $\varphi = \forall z\, \psi$ и $z \ne x$. Из условия $t-x-\varphi$ вытекает $z \not\in V(t)$ ($z$ --- связанная в $\varphi$) и $t - x - \psi$ или $x \not\in FV(\varphi)$. В первом случае, в силу предположения индукции и леммы 5 (о совпадающих оценках),
    \begin{multline*}
    [\varphi(t/x)](\pi) = [\forall z \psi(t/x)](\pi) = \\
    = \min\limits_{m \in M}[\psi(t/x)](\pi + (z \mapsto m)) = 
    \min\limits_{m \in M}[\psi](\pi + (z \mapsto m) + (x \mapsto [t](\pi + (z \mapsto m)))) = \\
    = \min\limits_{m \in M}[\psi](\pi + (z \mapsto m) + (x \mapsto [t](\pi))) =
    \min\limits_{m \in M}[\psi](\pi + (x \mapsto [t](\pi)) + (z \mapsto m)) = \\
     = [\forall z \psi](\pi + (x \mapsto [t](\pi)) = [\varphi](\pi + (x \mapsto [t](\pi)).
    \end{multline*}
    В случае $x \not\in FV(\varphi)$ верно также, что $x \not\in FV(\psi)$ (откуда и $t-x-\psi$), записанные равенства выполняются: применяем предположение индукции, а для всех оценок $\pi'$ и элементов $k, l \!\in\! M$ по лемме F5 $[\psi](\pi' + (x \mapsto k)) = [\psi](\pi' + (x \mapsto l))$.
    \end{proof}

    % Вопрос логика 11
    \subsection{Понятие корректной подстановки («терм свободен для переменной в формуле»). Пример некорректной подстановки. Лемма о корректной подстановке (без доказательства). [F, 73] Переименование связанной переменной. [F, 16, 18]. Общезначимость формул вида $\forall x \; \phi \to \phi(t/x)$ и $\phi(t/x) \to \exists x \; \phi$ в случае корректной подстановки. [F, 74]}
    
    Подставновка (неформально) --- замена свободной переменной в функции или формуле.
    
    \begin{example} $((x = 2) \vee (\forall x\, (x < y)))[z+5/x] = (z+5 = 2) \vee \forall x\, (x < y)$. \end{example}
    
    \textbf{Корректная подстановка } --- подстановка, где ни одна переменная в терме не оказывается случайно под действием квантора.
    
    \begin{example} 
        $\begin{array}{l} 
        (\forall x\, (x < y))[x/y] = \forall x\, (x < x) \text{ --- не является корректной подстановкой}, \\
        (\forall x\, (x < y))[z/y] = \forall x\, (x < z) \text{ --- является}.
        \end{array}$
    \end{example}
    
    \textbf{Лемма о корректной подстановке}\\[5 pt]
    В любой интерпретации при любой оценке $\pi$ дл всех $\varphi \in \text{Fm}_{\sigma}, \, 
    t, s \in \text{Tm}_{\sigma}$ и $x \in \text{Var}$, если $t-x-\varphi$, то
    \[ [s(t/x)](\pi) = [s](\pi + (x \mapsto [t](\pi))) \text{ и } [\varphi(t/x)](\pi) = [\varphi](\pi + (x \mapsto [t](\pi)). \]
    
    \textbf{Переименование связанной переменной}\\[5 pt]
    \textbf{Лемма 16} (достаточные условия для переименования связанных переменных). Пусть $y \not\in V(\varphi)$. Тогда
    \[ \forall x\, \varphi \equiv \forall y\, \varphi(y/x) \]
    
    \begin{proof}
        Индуктивное определение \textit{подстановки } для термов и формул:\\[-25 pt]
        \begin{itemize}
            \item если $t = z \in \text{Var}$ и $z \ne x$, то $t(y/x) = z$; если же $t = x$, то $t(y/x) = y$;
            \item если $t = \F_i$, то $t(y/x) = \F_i$; если $t = \F_j(t_1, \ldots, t_{a_j})$, то $t(y/x) = \F_j(t_1(y/x), \ldots, t_{a_j}(y/x))$;
            \item если $\varphi = \mathbbold{P}_i$, то $\varphi(y/x) = \F_i$; если $\varphi = \mathbbold{P}_j(t_1, \ldots, t_{b_j})$, то $\varphi(y/x) = \mathbbold{P}_j(t_1(y/x), \ldots, t_{b_j}(y/x))$;
            \item если $\varphi = \neg\psi$, то $\varphi(y/x) = \neg(\psi(y/x))$; если $\varphi = \psi_1 \wedge \psi_2$, то $\varphi(y/x) = \psi_1(y/x) \wedge \psi_2(y/x)$; аналогично для других связок;
            \item если $\varphi = \forall z\, \psi$ и $z \ne x$, то $\varphi(y/x) = \forall z\, (\psi(y/x))$; если же $z = x$, то $\varphi(y/x) = \forall x\, \psi = \varphi$ (формула не меняется). Случай квантора существования аналогичен.
        \end{itemize}
    \end{proof}
    
    \textbf{Лемма 18. } Для любого терма $t$ и любой формулы $\varphi$, если $y \not\in V(\varphi)$, то для всякой оценки $\pi$ верно
    \[ [t(y/x)](\pi) = [t](\pi + (x \mapsto \pi(y))) \text{ и} \]
    \[ [\varphi(y/x)](\pi) = [\varphi](\pi + (x \mapsto \pi(y))). \]
    
    \begin{proof}
        Индукция по построению. Пусть $t = z \ne x$. Имеем $[t(y/x)](\pi) = \pi(z) = [t](\pi + (x \mapsto \pi(y)))$. Если же $t = x$, то $[t(y/x)](\pi) = \pi(y) = [t](\pi + (x \mapsto \pi(y)))$. Случай $t = \F_i$ тривиален.\\[-10 pt]
    
    Если $t = \F_j(t_1, t_2, \ldots, t_{a_j})$, то по предположению индукции:
    \begin{multline*}
    [t(y/x)](\pi) = \F_j([t_1(y/x)](\pi), \ldots, [t_{a_j}(y/x)](\pi)) = \\
    = \F([t_1](\pi + (x \mapsto \pi(y))), \ldots, [t_{a_j}](\pi + (x \mapsto \pi(y)))) = [t](\pi + (x \mapsto \pi(y))).
    \end{multline*}
    
    Случай $\varphi = \mathbbold{P}_i$ тривиален (константа). Если $\varphi = \mathbbold{P}_j(t_1, t_2, \ldots, t_{b_j})$, то по предположению индукции:
    \begin{multline*}
    [\varphi(y/x)](\pi) = \mathbbold{P}_j([t_1(y/x)](\pi), \ldots, [t_{b_j}(y/x)](\pi)) = \\
    = \mathbbold{P}([t_1](\pi + (x \mapsto \pi(y))), \ldots, [t_{b_j}](\pi + (x \mapsto \pi(y)))) = [\varphi](\pi + (x \mapsto \pi(y))).
    \end{multline*}
    
    Рассмотрим случай $\varphi = \psi_1 \wedge \psi_2$:
    \begin{multline*}
    [\varphi(y/x)](\pi) = \min([\psi_1(y/x)](\pi), [\psi_2(y/x)](\pi)) = \\
    = \min([\psi_1](\pi + (x \mapsto \pi(y))), [\psi_2](\pi + (x \mapsto \pi(y)))) = [\varphi](\pi + (x \mapsto \pi(y))).
    \end{multline*}
    по предположению индукции. Случай квантора всеобщности:
    
    Пусть $\varphi = \forall z\, \psi$. Предположим, что $z \ne x$. Тогда, используя предположение индукции для $\pi' = \pi + (z \mapsto m)$ (т.к. утверждение доказывается для любой оценки), и учитывая $z \in V(\varphi), \, z \ne y, \, y \not\in V(\varphi)$, получаем
    \begin{multline*}
    [\varphi(y/x)](\pi) = [\forall z\,(\psi(y/x))](\pi) = \\
    = \underset{m \in M}{\min}[\psi(y/x)](\pi + (z \mapsto m)) =
    \underset{m \in M}{\min}[\psi](\pi + (z \mapsto m) + (x \mapsto (\pi + (z \mapsto m))(y))) = \\
    = \underset{m \in M}{\min}[\psi](\pi + (z \mapsto m) + (x \mapsto \pi(y))) = 
    \underset{m \in M}{\min}[\psi](\pi + (x \mapsto \pi(y)) + (z \mapsto m)) = \\
    = [\forall z\, \psi](\pi + (x \mapsto \pi(y))) = [\varphi](\pi + (x \mapsto \pi(y))).
    \end{multline*}
    
    Остается предположить, что $z = x$. Тогда в силу $x \not\in FV(\varphi)$ применима лемма 5:
    \[ [\varphi(y/x)](\pi) = [\varphi](\pi) = [\varphi](\pi + (x \mapsto \pi(y))). \]
     
    Теперь можно завершить доказательство леммы 16. Действительно, в любой интерпретации при произвольной
оценке $\pi$ по лемме 18 и, в силу $y \not\in FV(\varphi)$, по лемме 5 имеем
    \begin{multline*}
    [\forall y\, \varphi(y/x)](\pi) = \underset{m \in M}{\min}[\varphi(y/x)](\pi + (y \mapsto m)) = 
    \underset{m \in M}{\min}[\varphi](\pi + (y \mapsto m) + (x \mapsto (\pi + (y \mapsto m))(y))) = \\
    = \underset{m \in M}{\min}[\varphi](\pi + (y \mapsto m) + (x \mapsto m)) = 
    \underset{m \in M}{\min}[\varphi](\pi + (x \mapsto m)) = 
    [\forall x\, \varphi](\pi)
    \end{multline*}
    \end{proof}
    
    Сказанное позволяет объявить аксиомами ИП (общезначимыми формулами) все формулы из $\text{Fm}_{\sigma}$ вида\\[-25 pt]
    \begin{enumerate}
    \item[(A12)] $\forall x\, \varphi \to \varphi(t/x)$, если $t-x-\varphi$;
    \item[(A13)] $\varphi(t/x) \to \exists x\, \varphi$, если $t-x-\varphi$.
    \end{enumerate}
    \begin{proof}
        \begin{enumerate}
        \item[(A12)] Задавшись произвольной интерпретцией и оценкой $\pi$, допустим, что $[\forall x\, \varphi](\pi) =$\textbf{ 1}. Значит, $[\forall x\, \varphi](\pi + (x \mapsto m))$ для всех $m \in M$. В частности, взяв $m = [t](\pi)$, по лемме 73 получаем
        \[ [\varphi(t/x)](\pi) = [\varphi](\pi + (x \mapsto [t](\pi)) = \text{\bf 1}. \]
        \item[(A13)] Допустим, что $[\varphi(t/x)](\pi) =$ \textbf{ 1}, тогда по лемме 73: $[\varphi(t/x)](\pi) = [\varphi](\pi + (x \mapsto [t](\pi))$. Значит, $\exists m = [t](\pi)$ такое, что $[\varphi](\pi + (x \mapsto m)) = 1 \; \Leftrightarrow \; [\exists x\, \varphi](\pi) = 1$. Получили, что если посылка при какой-то оценке принимает значение 1, то и заключение при этой оценке принимает значение 1.
        \end{enumerate}
    \end{proof}

    % Вопрос логика 12
    \subsection{Переименование связанной переменной (без доказательства). [F, 16] Теорема о предваренной нормальной форме. [F, 36]}
    \begin{proposition}[Переименование связанных переменных]

        Если $y \notin V(\varphi)$, то $\begin{cases}
        \forall x \; \varphi \equiv \forall y \; \varphi(y/x) \\
        \exists x \; \varphi \equiv \exists y \; \varphi(y/x)
        \end{cases}$
    \end{proposition}

    \begin{definition}
        Формула $\varphi$ называется \textit{предварённой} или \textit{пренексной}, если $\varphi = Q_1y_1...Q_ny_n \: \psi$, где $Q_1,..Q_n$ --- некоторые кванторы, а $\psi$ --- бескванторная формула.
    \end{definition}

    \begin{theorem}
        $\forall \varphi \in Fm \;\; \exists \text{(не обязательно единственная) предварённая } \varphi' \text{такая, что } \varphi \equiv \varphi'$. Такая $\varphi'$ называется предварённой нормальной формой формулы $\varphi$.
    \end{theorem}
\vspace{-\baselineskip}
    \textbf{Неформально:} в абсолютно любой формуле можно вынести кванторы наружу.
\vspace{-\baselineskip}
    \begin{proof}
        Воспользуемся индукцией по построению $\varphi$.
        
        \textbf{База: } Если $\varphi = R(t_1..t_n)$ (то есть $\varphi$ атомарная), то $\varphi' = \varphi$ (сама уже предварённая). 
        
        \textbf{Шаг:}
        \begin{itemize}
        \item Если $\varphi = \forall x \psi$, то по предположению индукции $\exists$ предварённая $\psi'$ такая, что $\psi \equiv \psi'$, тогда $\varphi = \forall x \psi \equiv \forall x \psi' = \varphi'$. 
        \item Если $\varphi = \exists x \psi$, то по предположению индукции $\exists$ предварённая $\psi'$ такая, что $\psi \equiv \psi'$, тогда $\varphi = \exists x \psi \equiv \exists x \psi' = \varphi'$. 
        \item Если $\varphi = \neg \psi$, то по предположению индукции $\exists$ предварённая $\psi'$ такая, что $\psi \equiv \psi'$. Заметим, что $\psi'$ имеет вид $Q_1x_1..Q_nx_n \; \psi_0$, где $Q_1,..,Q_n$ --- кванторы, а $\psi_0$ бескванторная.
        
        $\varphi = \neg \psi \equiv \neg \psi' = \neg Q_1x_1..Q_nx_n \; \psi_0 = \overline{Q_1}x_1..\overline{Q_n}x_n \; \neg \psi_0 = \varphi'$ (здесь $\overline{\forall} = \exists, \overline{\exists} = \forall)$.
        \item $\varphi = \psi \wedge \theta$. По предположению индукции $\psi \equiv Q_1x_1..Q_nx_n \; \psi_0$, $\theta \equiv Q_1'y_1..Q_m'y_m \; \theta_0$
        
        $\varphi = Q_1x_1..Q_nx_n \; \psi_0 \wedge Q_1'y_1..Q_m'y_m \; \theta_0$. Пусть $z_1, .., z_n, w_1, .., w_m$ --- ''свежие''{} ($\notin V(\varphi)$) и различные между собой переменные. 
        
        Тогда по теореме о переименовании связанных переменных $\varphi \equiv  Q_1z_1..Q_nz_n \; \psi_0(z/x) \wedge Q_1'w_1..Q_m'w_m \; \theta_0(w/y) \equiv \\ \equiv Q_1z_1..Q_nz_n Q_1'w_1..Q_m'w_m \; \psi_0(z/x) \wedge \theta_0(w/y) = \varphi'$.
        
        Аналогичные рассуждения можно применить для остальных логических связок.
        \end{itemize}
    \end{proof}

    \begin{example}
        Приведем формулу $\neg \forall x Pxy \vee \exists y Qzxy$ к предварённой нормальной форме.
        \begin{gather*}
            \neg \forall x Pxy \vee \exists y Qzxy \implies \exists x \neg Pxy \vee \exists y Qzxy \implies \exists x' \neg Px'y \vee \exists y Qzxy \implies \\ \implies \exists x' (\neg Px'y \vee \exists y Qzxy) \implies \exists x' (\neg Px'y \vee \exists y' Qzxy') \implies \exists x' \exists y' (\neg Px'y \vee Qzxy')
        \end{gather*}
    \end{example}

    % Вопрос логика 13
    \subsection{Понятие теории первого порядка. Примеры содержательных теорий. Модель теории. Семантическое (логическое) следование (для замкнутых формул) [ВШ-2, с. 187]}
        \begin{definition}
            Теория(в сигнатуре $\sigma$) - любое множество предложений этой 
            сигнатуры. 
        \end{definition}
        \begin{definition}
            $M \vDash T \iff \forall \phi \in T : M \vDash \phi$, то есть 
            если каждое предложение в нашей интерпретации истинно, то 
            и вся теория. Множество $M$ будет моделью нашей теории.
        \end{definition}
        \begin{definition}
            Теория $T$ выполнима(или совместна) $\iff \exists
            M :  M \vDash T$
        \end{definition}
        \begin{definition}
            Предложение $\phi$ следует из теории $T$, если $\forall 
            M : M \vDash T \Rightarrow M \vDash \phi$
        \end{definition}
        В примерах мы работаем в нормальных моделях(то есть равно - это привычное нам равно)
        \begin{example}
            $T_{ord}$ - частичный порядок,
            $T = 
            \begin{cases}
                \forall x : \neg (x < x), \text{антирефлексивность} \\
                \forall x : \forall y : \forall x : (x < y) \wedge\ (y < z) \Rightarrow (x < z), \text{транзитивность} \\
            \end{cases}$

            Работаем в структуре $M = (A, =, <)$       
        \end{example}
        \begin{proposition}
            $\forall M : M \vDash T \Rightarrow M \vDash  \forall x : \forall y : (x < y \wedge y < x \Rightarrow (x = y))$, то есть 
            антисимметричность следует из транзитивности и антирефлексивности
     
        \end{proposition}
        \begin{proof}
            Предположим, что наша посылка($x < y \wedge y < x$) истинна. Воспользуемся 
            транзитивностью: $(x < y \wedge y < x) \Rightarrow (x < x)$. Получили 
            противоречие, так как в нашей теории есть антирефлексифность, которая говорит, что 
            $x < x$ никогда не верно. Значит, посылка всегда ложная, а интерпетация 
            всегда истинна.
        \end{proof}
        \begin{example}
            $G = (A, =, +, -, 0)$ - структура, это группа, когда в ней 
            выполняется теория $T$ = теория групп,
            $T = 
            \begin{cases}
                \forall x : \forall y : \forall z : (x + y) + z = x + (y + z), \text{ассоциативность} \\
                \forall x : (x + (-x) = 0) \wedge ((-x) + x = 0), \text{обратный элемент} \\
                \forall x : (x + 0 = x) \wedge (0 + x = x), \text{нейтральный элемент} \\
            
            \end{cases}.$    
               
        \end{example}
        
    % Вопрос логика 14
    \subsection{Сколемизация предварённой формулы. Сколемовская нормальная форма. Теорема о равновыполнимости.}

    \begin{definition}
        \textit{Сколемизацией} предварённой формулы называется преобразование следующего вида:
        \[
        \forall \overrightarrow{x} \: \exists y \: \varphi \rightarrow_S \forall \overrightarrow{x} \: \varphi\left(f(\overrightarrow{x})/y\right)
        \]
    \end{definition}
    \vspace{-\baselineskip}
    \textbf{Неформально:} мы заменяем одну переменную под квантором существования на функцию от переменных под кванторами всеобщности. \\

    \begin{definition}
        Предварённая формула $\varphi'$ --- \textit{сколемовская нормальная форма} предварённой формулы $\varphi$, если:
        \vspace{-\baselineskip}
        \begin{enumerate}
            \item в $\varphi'$ нет кванторов существования;
            \item $\varphi \rightarrow_S \varphi_1 \rightarrow_S ... \rightarrow_S \varphi_n \rightarrow_S \varphi'$ (обозначается $\varphi \twoheadrightarrow_S \varphi'$), то есть $\varphi'$ получается из $\varphi$ цепочкой сколемизаций. \\
        \end{enumerate} 
    \end{definition}

    \begin{fact}
        Если $\varphi \twoheadrightarrow_S \varphi'$, то $\varphi$ выполнима $\iff$ $\varphi'$ выполнима.
    \end{fact}
    
    \begin{definition}
        $\Gamma$ выполнимо $\iff$ $\exists \mathcal{M} \exists \pi~ [\Gamma]_{\mathcal{M}}(\pi) = 1$.
    \end{definition}
    
    \begin{definition}
        Множества формул $\Gamma$ и $\Delta$ {\it равновыполнимы} $\iff$ ($\Gamma$ выполнимо $\iff$ $\Delta$ выполнимо).
    \end{definition}
    
    \begin{proposal}
        Для любой предварённой формулы $\varphi$ такой, что она не содержит фиктивных кванторов, существует сколемовская нормальная форма $\psi$ такая, что $\varphi \twoheadrightarrow_{S} \psi$.
    \end{proposal} \vspace{-\baselineskip}
    \begin{proof}
        Применим алгоритм сколемизации и заметим, что кванторов у нас конечное число, поэтому алгоритм точно остановится. \\
    \end{proof}

    \begin{theorem}[о сколемизации]
        Пусть $\Gamma \subseteq \text{Fm}$ и $\varphi \to_{S} \psi$.
        Тогда $\Gamma \cup \{\varphi\}$ и $\Gamma \cup \{\psi\}$ равновыполнимы.
    \end{theorem}
    
    Что это означает?
    Это означает, что у нас было какое-то множество формул (хочется сказать теорий, но в нашем множестве могут быть свободные переменные), мы взяли оттуда одну формулу и подвергли ее сколемизации.
    Тогда то, что получилось, равновыполнимо с исходным множеством.
    
    \begin{proof}
        Раз у нас была сколемизация, то $\varphi \eqcirc \forall \vec{x} \exists y \theta$, а $\psi \eqcirc \forall \vec{x}~ \theta(f\vec{x}/y)$, где $f$ <<свежая>>, то есть, в частности, $f$ \underline{не встречается} в $\Gamma$.
        Сделаем несколько наблюдений:
        \begin{enumerate}
            \item В формуле $\exists y \theta$ нет кванторов по $\vec{x}$ (иначе в $\varphi$ есть фиктивный квантор) $\implies f\vec{x}$-$y$-$\theta$, ну а раз подстановка корректная, то формула $\theta(f\vec{x}/y) \implies \exists y \theta$ общезначима.
            Поскольку формула общезначима, то, по факту с семинара, формула $\forall \vec{x} \theta(f\vec{x}/y) \implies \forall \vec{x} \exists y \theta$ также общезначима.
            Вспомним про определение $\varphi$ и $\psi$, и заметим, что $\psi \implies \varphi$, то есть, в любой структуре, где верно $\psi$, верно и $\varphi$.
            Тогда если $\exists \mathcal{M}~ \exists \pi$ такие, что $[\Gamma \cup \{\psi\}]_{\mathcal{M}}(\pi) = 1$, то $[\Gamma \cup \{\varphi\}]_{\mathcal{M}}(\pi) = 1$.
            Значит, если $\Gamma \cup \{\psi\}$ выполнима, то $\Gamma \cup \{\varphi\}$ выполнима.
            \item Допустим, что $\Gamma \cup \{ \forall \vec{x} \exists y \theta \}$ выполнима.
            Тогда $\exists \mathcal{M}$ $\exists \pi$ ($[\Gamma]_{\mathcal{M}}(\pi) = 1$ и $[\forall \vec{x} \exists y \theta]_{\mathcal{M}}(\pi) = 1$).
            Заметим, что
            $$
            [\forall \vec{x} \exists y \theta]_{\mathcal{M}}(\pi) = 1 \iff \forall \vec{a} \in M~ \exists b \in M~ [\theta]_{\mathcal{M}}(\pi_{x~y}^{\vec{a}~b}) = 1.
            $$
            Теперь рассмотрим $\mathcal{M}^{\prime} = (\mathcal{M}, f^{\mathcal{M}})$ (мы расширили структуру, добавив\footnote{Такая операция называется {\it обогащением} структуры $\mathcal{M}$.} в нее интерпертацию символа $f$).
            Как мы можем ее расширить?
            Для этого нам нужно определить значение $f^{\mathcal{M}}(\vec{a})$.
            Положим его равным $b \in M$ такому, что $\forall \vec{a} [\theta]_{\mathcal{M}}(\pi_{x~y}^{\vec{a}~b}) = 1$, то есть, $\forall \vec{a} \in M^{n}~ [\theta]_{\mathcal{M}}(\pi_{x~y}^{\vec{a}~f^{\mathcal{M}}(\vec{a})}) = 1$.
            Такая $f^{\mathcal{M}}$ существует в силу аксиомы выбора.
            Ну вот мы взяли такую интерпретацию, дальше мы хотим посмотреть, что же будет с $\psi$ и ее значением
            $$
            [\forall \vec{x} \theta (f\vec{x}/y)]_{\mathcal{M}^{\prime}}(\pi).
            $$
            В старой структуре у нее вообще не было значения, потому что там у нас не интерпретировался символ $f$.
            В новой же структуре
            $$
            [\forall \vec{x} \theta (f\vec{x}/y)]_{\mathcal{M}^{\prime}}(\pi) = 1 \iff \forall \vec{a} \in M~ [\theta(f\vec{x}/y)]_{\mathcal{M}^{\prime}}(\pi_{\vec{x}}^{\vec{a}}) = 1.
            $$
            Докажем последнее равенство.
            Мы можем воспользоваться леммой о корректной подстановке и получится, что
            $$
            [\theta(f\vec{x}/y)]_{\mathcal{M}^{\prime}}(\pi_{\vec{x}}^{\vec{a}}) = [\theta]_{\mathcal{M}^{\prime}}\left(\pi_{\vec{x}~y}^{\vec{a}~[f\vec{x}]_{\mathcal{M}^{\prime}}(\pi_{x}^{\vec{a}})}\right) = [\theta]_{\mathcal{M}^{\prime}}\left(\pi_{\vec{x}~y}^{\vec{a}~f^{\mathcal{M}}(\vec{a})}\right) \overset{f\text{ --- свежая}}{=} [\theta]_{\mathcal{M}}\left(\pi_{x~y}^{\vec{a}~f^{\mathcal{M}}(\vec{a})}\right) = 1
            $$
            Итак, $[\varphi]_{\mathcal{M}^{\prime}}(\pi) = 1$.
            А что с $\Gamma$?
            В $\Gamma$ ничего не изменится, поскольку $f$ не встречается в $\Gamma$, поэтому
            $$
            [\Gamma]_{\mathcal{M}^{\prime}}(\pi) = [\Gamma]_{\mathcal{M}}(\pi) = 1.
            $$
            Таким образом, $[\Gamma \cup \{ \varphi\}]_{\mathcal{M}^{\prime}}(\pi) = 1$, то есть $\Gamma \cup \{\psi\}$ выполнима. \qedhere
        \end{enumerate}
    \end{proof}
    
    % Вопрос логика 15
    \subsection{Исчисление резолюций для произвольных множеств формул. Теорема о коррект- ности.
        Теорема о полноте (без доказательства).}

    В исчислении резолюций есть 2 правила.


    \underline{Правило вывода (резолюции)}. $\boxed{\frac{\neg A \lor B \; \; \; A \lor C}{B \lor C} } $

    Частный случай ПР -- вывод пустой дизъюнкции (лжи): $\frac{A \; \; \; \neg A}{\perp}.$



    \underline{Правило подстановки.} $\boxed{\frac{\forall y A}{A(t/y)}} \; $, где $t$ -- произвольный терм, $A$ -- универсальна.
    
    \textit{Универсальная формула} -- это формула вида $\forall \, \overset{\to}{x} \; \varphi_0$, где $\varphi_0$ -- бескванторная. Иными словами, УФ -- это сколемовская нормальная форма.

    Говорят, что формула $\varphi$ \underline{выводится} из множества  формул $\Gamma$ в исчислении резолюций, если $\varphi$ возможно получить из формул в $\Gamma$, применяя к ним правило резолюции и правило подстановки какое-то конечное число раз.

    Обозначение: $\Gamma \vdash \varphi.$

    \underline{Корректность ПР}. $\forall M \; \forall \pi$ если $[\neg A \lor B]_M (\pi) = 1$  и $[ A \lor C]_M (\pi) = 1,$ то $[B \lor C]_M (\pi) = 1.$

    Другими словами, импликация $( (\neg A \lor B) \land (A \lor C) \to (B \lor C) )$ общезначима.

    \begin{proof} По контрапозиции.

    $[B \lor C]_M (\pi) = 0 \implies \left([B]_M (\pi) = 0\right) \land \left([C]_M (\pi) = 0\right) \implies [\neg A \lor B]_M (\pi) = 0 \lor   [ A \lor C]_M (\pi) = 0 \implies$

    $ \neg([\neg A \lor B]_M (\pi) = 1 \land   [ A \lor C]_M (\pi) = 1).$
    \end{proof}


    \underline{Корректность ПП.} Пусть $A$ -- универсальна.

    $\forall M \; \forall \pi$ если $[ \, \forall y \,  A \, ]_M (\pi) = 1,$  то $[ \, A(t/y) \, ]_M (\pi) = 1.$

    \begin{proof}
    Допустим, $A \eqcirc \forall \, \overrightarrow{x} A_0$, где $A_0$ -- бескванторная формула.

    $[\forall \, y \, \forall \, \overrightarrow{x} \, A_0 ]_M (\pi) = 1 \iff \forall \, a \in M \, \forall  \overrightarrow{b} \in M^n \;  \; [A_0] \left(\pi^{a \; \; \overrightarrow{b}}_{y \; \; \overrightarrow{x}} \right) = 1 \iff \forall  \overrightarrow{b} \in M^n \;   \forall \, a \in M  \;  \; [A_0] \left(\pi^{\overrightarrow{b} \; \; a}_{\overrightarrow{x} \; \; y} \right) = 1.$

    Теперь положим $a := [ \, t \,]  \left(\pi_{\overrightarrow{x}}^{\overrightarrow{b}} \right) \implies \forall \overrightarrow{b} \in M^n \; [A_0] \left( \pi_{\overrightarrow{x} \; \; \, y}^{\overrightarrow{b} \; \; \; [ \, t \,]  \left(\pi_{\overrightarrow{x}}^{\overrightarrow{b}} \right)} \right) = 1. \; \; \circledast$

    С другой стороны $[A(t/y)]_M(\pi) = 1 \iff [ \, \forall \overrightarrow{x} \; A_0 (t/y) \,  ]_M (\pi) = 1 \iff \forall \overrightarrow{b} \in M^n \; [ \, A_0(t/y) \, ]_M \left(\pi_{\overrightarrow{x}}^{\overrightarrow{b}} \right) = 1.$

    Так как в $A_0$  нет кванторов, $t-y-A_0.$ Тогда по лемме о корректной подстановке

    $\forall \overrightarrow{b} \in M^n \; [ \, A_0(t/y) \, ]_M \left(\pi_{\overrightarrow{x}}^{\overrightarrow{b}} \right) = 1 \iff \forall \overrightarrow{b} \in M^n \; [A_0] \left( \pi_{\overrightarrow{x} \; \; \, y}^{\overrightarrow{b} \; \; \; [ \, t \,]  \left(\pi_{\overrightarrow{x}}^{\overrightarrow{b}} \right)} \right) = 1,$ что совпадает с  $\circledast.$ Равносильность доказана.

    \end{proof}

    \underline{Теорема о корректности.} Если $\Gamma \vdash \varphi,$ то $\Gamma \vDash \varphi.$

    \begin{proof} Индукция по построению вывода в ИР.

    Применяем утверждения о корректности ПП и ПР, доказанные выше.
    \end{proof}

    \underline{Теорема о полноте}. $\Delta$ -- набор формул в сигнатуре $\sigma$. Если $\Delta \nvdash \perp$, то $\exists M \, \exists \pi \; [\Delta]_M (\pi) = 1,$ причём $|M| \leq max(|\mathbb{N}|, \, | \sigma|). $


    % Вопрос логика 16
    \subsection{Исчисление резолюций для произвольных множеств формул. Теоремы о корректности и о полноте (обе без доказательства). Доказывание общезначимости и логического следования в теории с помощью исчисления резолюций. Пример применения исчисления резолюций (должны присутствовать формулы, не являющиеся универсальными дизъюнктами).}
    
    В исчислении резолюций есть 2 правила.
    
    \underline{Правило вывода (резолюции)}. $\boxed{\frac{\neg A \lor B \; \; \; A \lor C}{B \lor C} } $
    
    Частный случай ПР -- вывод пустой дизъюнкции (лжи): $\frac{A \; \; \; \neg A}{\perp}.$
    
    \underline{Правило подстановки.} $\boxed{\frac{\forall y A}{A(t/y)}} \; $, где $t$ -- произвольный терм, $A$ -- универсальна.
    
    \textit{Универсальная формула} -- это формула вида $\forall \, \overset{\to}{x} \; \varphi_0$, где $\varphi_0$ -- бескванторная. Иными словами, УФ -- это сколемовская нормальная форма.
    
    Говорят, что формула $\varphi$ \underline{выводится} из множества  формул $\Gamma$ в исчислении резолюций, если $\varphi$ возможно получить из формул в $\Gamma$, применяя к ним правило резолюции и правило подстановки какое-то конечное число раз.
    
    Обозначение: $\Gamma \vdash \varphi.$
    
    \underline{Теорема о корректности.} Если $\Gamma \vdash \varphi,$ то $\Gamma \vDash \varphi.$
    
    \underline{Теорема о полноте}. $\Delta$ -- набор формул в сигнатуре $\sigma$. Если $\Delta \nvdash \perp$, то $\exists M \, \exists \pi \; [\Delta]_M (\pi) = 1,$ причём $|M| \leq max(|\mathbb{N}|, \, | \sigma|). $
    
    Как доказать общезначимость формулы $\varphi$? Знаем, что 
    
    $\varphi$ общезначима $\iff \neg \, \varphi$ не выполнима $\iff \{ \neg \, \varphi\}$ не выполнима. 
    
    Так что \underline{достаточно вывести из теории $\{ \neg \, \varphi\}$ ложь} (с помощью ИР).
    
    \textit{Пример:} $\varphi \eqcirc \forall x \, \exists y \, \forall z \, Pxyz \to \exists y \, \forall z \, \exists x  \, Pxyz.$ Доказать, что она общезначима.
    
    $\neg \, \varphi \equiv \forall x \, \exists y \, \forall z \, Pxyz \land \neg \, \exists y \, \forall z \, \exists x  \, Pxyz \equiv \forall x \, \exists y \, \forall z \, Pxyz \land  \, \forall y \, \exists z \, \forall x  \, \neg \, Pxyz \equiv \forall x \, \exists y \, \forall z \, Pxyz \land  \, \forall v \, \exists w \, \forall u  \, \neg \, Puvw \equiv \\ \\ \forall x \, \exists y \, \forall z  \, \forall v \, \exists w \, \forall u \, (Pxyz \land  \neg \, Puvw).$ 
    
    Сколемизируем, $y \rightsquigarrow f(x) \implies \dots \equiv \forall x  \, \forall z  \, \forall v \, \exists w \, \forall u \, (Px \, (fx)\, z \land  \neg \, Puvw).$
    
    Второй шаг сколемизации, $w \rightsquigarrow g(x,z,v) \implies \dots \equiv \forall x \, \forall z  \, \forall v \, \forall u \, (Px \, (fx)\, z \land  \neg \, Puv \, (g \, xzv)). $
    
    Делаем из получившейся штуковины теорию. Заметим, что она не является универсальным дизъюнктом. Поэтому мы имеем право разбить её на несколько УД. Наша теория, в итоге, выглядит так:
    
    $\{\forall x \, \forall z  \, \forall v \, \forall u \, (Px \, (fx)\, z )  , \; \; \forall x \, \forall z  \, \forall v \, \forall u \, \neg \, Puv \, (g \, xzv)\}$
    
    Выведем из неё ложь:
    
    $\frac{\forall x \, \forall z  \, \forall v \, \forall u \, (Px \, (fx)\, z )}{P u \, f(u)\, (g \, uz \, (fu)\,)}$ -- правило подстановки, сделали $\begin{cases}
    x := u; \\
    z := g \, uz \, (fu) \\
    \end{cases}$
    
    $ \frac{\forall x \, \forall z  \, \forall v \, \forall u \, \neg \, Puv \, (g \, xzv)}{\neg Pu \, f(u) \,(g \, uz \, (fu) \, )} $ -- правило подстановки, сделали $\begin{cases}
    x := u; \\
    v := fu; \\
    z := z; \\
    u := u
    \end{cases}$
    
    $\frac{P u \, f(u)\, (g \, uz \, (fu)\,)  \; \; \; \neg Pu \, f(u) \,(g \, uz \, (fu) \, ) }{\perp}$  -- правило резолюций.
    
    Всё -- УРА, доказали, что исходная  $\varphi$ общезначима.
    

    % Вопрос логика 17
    
    \subsection{Теорема компактности (в двух формах: про выполнимость и про логическое следование). Вариант для нормальных моделей (без доказательства). Любой пример применения.}

    \underline{Теорема о компактности-1.}
    
    Если каждое конечное подмножество $\Gamma$ выполнимо ($\iff \Gamma$ "конечно выполнимо"), то $\Gamma$ выполнимо.

    \begin{proof} Контрапозиция. Пусть $\Gamma$ не выполнимо $\implies \Gamma^* \vdash \perp$  по теореме о полноте.
    
    Любой вывод в ИР -- конечное дерево $\implies \exists $ конечное $\Delta \subseteq \Gamma^*$ $\Delta \vdash \perp \implies \exists$ конечное $\Gamma_1 \subseteq \Gamma$, т.ч. $\Delta \subseteq \Gamma^*_1$ и $\Gamma^*_1 \vdash \perp.$
    
    По теореме о корректности $\Gamma^*_1$ невыполнимо $\implies \Gamma_1$ невыполнимо.
    
    Т.е. нашлось конечное невыполнимое подмножество $\Gamma.$
    
    \end{proof}
    
    \underline{Теорема о компактности-2.} Если $\Gamma \vDash \varphi,$ то $\exists$ конечное $\Gamma' \subseteq \Gamma \; \; \Gamma' \vDash \varphi.$
    
    \begin{proof} 

    $\Gamma \vDash \varphi \iff $ невыполнима  $\Gamma \cup \{ \neg \varphi\} \implies \exists$  конечное $\Gamma' \subseteq \Gamma \; \; \Gamma' \cup \{\neg \varphi \}$  невыполнима $\iff \Gamma' \vDash \varphi.$
    
    \end{proof}
    
    Определим $Ax_{=}^{\sigma}$ (аксиомы равенства).
    
    $Ax_{=}^{\sigma}: \{ \, \forall x \; (x = x) \, , \; \; \forall x \;  \forall y \;  (x = y \to y = x) \, , \; \; \; \forall x \; \forall y \; \forall z \;  (x = y \land y = z \to x = z) \, \} \cup \\ \\ \{ (x_1 = y_1 \land \dots \land x_n = y_n) \to ( R_{x_1 \dots x_n} = R_{y_1 \dots y_n})  \mid R^{(n)} \in Rel_{\sigma} \} \cup \\ \{ (x_1 = y_1 \land \dots \land x_n = y_n) \to (f_{x_1 \dots x_n} = f_{y_1 \dots y_n})  \mid f^{(n)} \in Fnc_{\sigma}\}.$ \\
    
    \underline{Утверждение.} Пусть в $\sigma$ есть равенство. У $\Gamma$ есть нормальная модель $(\leq max(|\mathbb{N}|, |\sigma|)) \iff $  выполнима $\Gamma \cup Ax_{=}^{\sigma}.$
    
    \begin{proof}
    $\boxed{\Rightarrow}$ В нормальной модели выполняются аксиомы равенства.
    
    $\boxed{\Leftarrow}$ В каком случае модель, в которой выполнена теория $Ax_{=}^{\sigma} \cup \Gamma$, может оказаться не нормальной? 
    
    Только если у каких-то элементов есть "двойники". 
    
    В этом случае модифицируем модель и склеим все дублирующиеся элементы. $Ax_{=}^{\sigma} \cup \Gamma$ всё ещё выполнима, так как наличие или отсутствие двойников ничего не меняет, но модель уже является нормальной, чего мы и хотели.
    
    \end{proof}
    
    \doublespacing \underline{Компактность для нормальных моделей.} Если у каждого конечного подмножества $\Gamma$ есть нормальная модель, то у $\Gamma$ есть нормальная модель (мощности $\leq max (|\mathbb{N}| , | \sigma| )$).
    
    \begin{proof}
    
    По утверждению выше, $\forall$ конечного $\Gamma_1 \subseteq \Gamma$ выполнима $\Gamma_1 \cup Ax_{=}^{\sigma}$  $\implies \\ 
    \forall$ конечное подмножество $ \Gamma' \subseteq \Gamma \cup Ax_{=}^{\sigma} $ выполнимо $\implies \\ \Gamma \cup Ax_{=}^{\sigma}$ выполнимо (по обычной компактности) $\implies$ у $\Gamma$ есть нормальная модель из утверждения выше.
    
    \end{proof}

    % Вопрос логика 18
    
    \subsection*{Игра Эренфойхта. Формулировка основной теоремы и примеры применения: когда побеждает Новатор, и когда побеждает Консерватор.}
    
    $\bullet \;$ Чтобы доказать, что 2 структуры не являются элементарно эквивалентными, достаточно привести контрпример. Но для доказательства элементарной эквивалентности необходимо пользоваться \underline{игрой Эренфойхта.}
    
    Пусть $\sigma $ -- сигнатура, где $(I)$ нет функциональных и константных символов (т.е. сигнатура состоит лишь из предикатных символов); $(II) \; \sigma$ конечна.
    
    Пусть $N, \, M$ -- две $\sigma$-структуры.  Два игрока, называемые Новатором (Н) и Консерватором (К), играют в такую игру:
    
    Н объявляет продолжительность игры в $n \in \mathbb{N}$ ходов. 
    
    Н делает первых ход и выбирает в одной из структур элемент $a_1.$ В ответ на это консерватор выбирает в другой структуре элемент $b_1$,  который является "аналогом" $\;a_1$. Затем Н делает очередной шаг, и всё повторяется $n$ раз.
    
    \textit{Пример игры. Н -- квадратик, К -- кружок}
    
    \begin{tabular}{cc}
         $M$ & $N$ \\
         \tikz\node[draw]{$\overset{ }{a_1}$}; & \tikz\node[draw, circle]{$b_1$}; \\
         \tikz\node[draw]{$\overset{ }{a_2}$}; & \tikz\node[draw, circle]{$b_2$}; \\
         \tikz\node[draw, circle]{$\overset{ }{a_3}$}; & \tikz\node[draw]{$b_3$}; \\
         \dots &\dots\\
         $a_n$ & $b_n$ \\
    \end{tabular}
    
      В результате получилось какое-то конечное соответствие между элементами $M$ и $N$.
      
      \underline{Кто выигрывает?} 
      
      $K$ выигрывает $\iff$ \{ни один предикат из $\sigma$  не отличает $a_1 \dots a_n $  от  $b_1 \dots b_n $\} $\iff\\
      \forall R^k \in Rel_\sigma \; \forall \; 1 \leq i_1,  \dots i_k \leq n \; \; \;  (a_{i_1} \dots a_{i_k}) \in R^M \iff  (b_{i_1} \dots b_{i_k}) \in R^N. $
      
      Иначе выигрывает новатор.
      
      \underline{Суть}: консерватор пытается доказать, что структуры нельзя различить. Новатор же ищет различия.
    
    \textit{Пример 1.} $(\mathbb{N}, \, <)$ и $(\mathbb{Z}, \, <)$. 
    
    Новатор выигрывает при любой игре консерватора (т.е. у Н есть выигрышная стратегия). 
    
    Новатор: $n = 2.$
    
    \begin{tabular}{cc}
         $(\mathbb{N}, \, <)$ & $(\mathbb{Z}, \, <)$ \\
         \tikz\node[draw]{$0$}; & \tikz\node[draw, circle]{$n$}; \\
         \tikz\node[draw, circle]{$\overset{ }{m}$}; & \tikz\node[draw]{$n - 1$}; \\
    \end{tabular}
    
    $n, \; m$ -- произвольные числа, которые выбрал К (мы пытаемся доказать, что выигрыш не зависит от игры К). 
    
    Новатор победил, ведь $(m \nless_{\mathbb{N}} \, 0)$,  но $(n - 1 <_{\mathbb{Z}} \, n).$
    
    \underline{Теорема.} $M \equiv N \iff $ в игре Эренфойхта для $M$ и $N$ у консерватора есть выигрышная стратегия ($\iff$ различие найти нельзя ни за какое конечное число шагов). 
    
    \textit{Пример 2.} 
    
    Новатор: $n = 3.$
       
    \begin{tabular}{cc}
         $(\mathbb{Z}, \, <)$ & $(\mathbb{Q}, \, <)$ \\
         $a_1$ = \tikz\node[draw]{$0$}; & \tikz\node[draw, circle]{$q_1$}; = $b_1$\\
         $a_2$ =  \tikz\node[draw]{$1$}; & \tikz\node[draw]{$q_2$}; = $b_2$\\
         $a_3$ = \tikz\node[draw, circle]{$n$}; & \tikz\node[draw]{$\frac{q_1 + q_2}{2}$}; = $b_3$\\
    \end{tabular}
    
    К проиграл, ведь $b_1 <_\mathbb{Q} b_2 <_\mathbb{Q}  b_3$, однако $\forall \, n \; \neg \; (a_1 <_\mathbb{Z} a_2 <_\mathbb{Z}  a_3)$, так как неверно $0 <_\mathbb{Z} n <_\mathbb{Z} 1$.
    
    \textit{Пример 3.} Докажем через игру Эренфойхта, что $(\mathbb{Q}, <) \equiv (\mathbb{R}, <) .$ 
    
    \begin{proof}
    Достаточно доказать, что у К есть выигрышная стратегия.
    
    К должен уметь для $\forall \; n \in \mathbb{N}$  продержаться  $n$ ходов, чтобы не возникло отличия между структурами.
    
    Индукция по $n$.
    
    База. $n = 1 \implies $ Н не сможет выиграть, ведь предикат у нас бинарный. 
    
    Точнее, если $a_1, \; b_1$ -- соответствующие ходы, то в обеих структурах всегда верно $a_1 \nless a_1; \; b_1 \nless b_1.$
    
    Переход. Пусть К не проигрывает за $n$  ходов. Докажем, что он может продержаться ещё один ход.
    
    Игра сейчас имеет вид: 
    
     \begin{tabular}{ccc}
         $(\mathbb{Q}, \, <)$ & & $(\mathbb{R}, \, <)$ \\
         $a_1$ & $\xrightarrow{\alpha}$  & $b_1$\\
         $a_2$ & $\xrightarrow{\alpha}$  & $b_2$\\
         $\dots$ & $\xrightarrow{\alpha}$  & $\dots$\\
         $a_n$ & $\xrightarrow{\alpha}$  & $b_n$
    \end{tabular}
    
    Мы задали по данной партии отображение $\alpha(a_i) = b_i.$
    
    К не проиграл $\iff$ $\alpha$ -- изоморфизм, т.е. $\forall \; i, j \; \;  a_i < a_j \iff b_i < b_j.$
    
    Упорядочим $a_i$ по возрастанию:  $ \; a_{(1)} < a_{(2)} < \dots < a_{(n)}$. Упорядочим  $b_i$ аналогично.
    
    Тогда $\alpha(a_{(i)}) = b_{(i)}$ в силу $\forall \; i, j \; \;  a_i < a_j \iff b_i < b_j.$
    
    \textit{Замечание. Если вдруг $a_i = a_j \implies \neg \; (a_i < a_j) \land \neg \; (a_j < a_i) \implies
     \neg \; (b_i < b_j) \land \neg \; (b_j < b_i) \implies b_i = b_j.$ В силу этого мы имеем право игнорировать повторы (если найдутся равные элементы, то в неравенстве выше просто будут фигурировать $l < n$ элементов,  его суть же от этого не изменится).}
    
    Теперь пусть Н сделал какой-то ход, условно, он выбрал $b$ в $\mathbb{R}$  (для $\mathbb{Q}$ аналогично).
    
    Случай 1. $b < b_{(1)} \implies$ К отвечает каким-то  $a $, т.ч. $a < a_{(1)}.$ Это возможно, ведь в $(Q, \, <)$ нет минимального.
    
    Случай 2. $b_{(l)} < b  \implies$ К отвечает каким-то  $a $, т.ч. $a_{(l)} < a.$ Это возможно, ведь в $(Q, \, <)$ нет максимального.
    
    Случай 3. $b_{(i)} < b < b_{(i + 1)} \implies $   К отвечает каким-то  $a $, т.ч. $a_{(i)} < a < a_{(i + 1)}.$ Это возможно, ведь  $(Q, \, <)$ -- плотный.
    
    Итого -- в любом кейсе К не проиграл. Ч.т.д.
    
    \end{proof}
    
    Как следствие получим, что  если $M$ и $N$ -- плотные лин. порядки без наибольшего и наименьшего элемента, то  $M \equiv N.$  (Все рассуждения выше применимы к любому $DLO$ без наименьшего и наибольшего элемента).
    

\end{document}
